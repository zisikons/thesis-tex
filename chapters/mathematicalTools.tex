\chapter{Μαθηματικά Εργαλεία} \label{chap:mathematical_tools}

Στο κεφάλαιο αυτό γίνεται εισαγωγή των μαθηματικών εργαλείων και βασικών εννοιών στα οποία βασίζεται η διπλωματική εργασία. Σκοπός του κεφαλαίου είναι η συμφιλίωση του αναγνώστη με αυτές τις έννοιες, έτσι ώστε να γίνει ομαλή η μετάβαση στα αποτελέσματα της διπλωματικής εργασίας στα κεφάλαια που ακολουθούν. 

Συνοπτικά, τρία είναι τα εργαλεία που θα παρουσιαστούν. Αρχικά θα γίνει μια εισαγωγή στα νευρωνικά δίκτυα RBF με έμφαση στην αρχιτεκτονική τους, στον τρόπο που χρησιμοποιούνται στις εφαρμογές αναγνώρισης και ελέγχου, καθώς και τις προσεγγιστικές τους ιδιότητες. Στην συνέχεια θα παρουσιαστεί ο Έλεγχος Προδιαγεγραμμένης Απόκρισης, ο σκοπός που χρησιμοποιείται σε αυτή την εργασία καθώς και επιχειρήματα που αποδεικνύουν την εγκυρότητα του, τόσο σε μαθηματικό επίπεδο όσο και με την χρήση προσομοιώσεων. Τέλος, θα γίνει μια συνοπτική εισαγωγή στην αρχιτεκτονική του υποσυστήματος που παράγει τα σήματα αναφοράς του σχήματος, καθώς και ποιοι είναι οι λόγοι που χρησιμοποιείται αυτή η μεθοδολογία και όχι κάποια άλλη.

Τέλος, θα αφιερώσουμε μια επιπλέον παράγραφο στην παρουσίαση και μελέτη της Συνθήκης Επιμένουσας Διέγερσης, καθώς μεγάλο τμήμα αυτής της εργασίας ασχολείται με την ικανοποίηση της.

\section{Νευρωνικά Δίκτυα RBF}
\label{sec:rbf_networks}
Με τον όρο \textit{Tεχνητά Νευρωνικά Δίκτυα} (Artificial Neural Networks) αναφερόμαστε σε μια κατηγορία μαθηματικών μοντέλων τα οποία προέκυψαν την δεκαετία του 1940 και είναι εμπνευσμένα από τα βιολογικά νευρωνικά δίκτυα τα οποία απαντώνται στους εγκεφάλους των ανθρώπων και των ζώων. Το κύριο χαρακτηριστικό των νευρωνικών δικτύων είναι η εγγενής ικανότητα μάθησης. Ως μάθηση μπορεί να οριστεί η σταδιακή βελτίωση της ικανότητας του δικτύου να επιλύει κάποιο πρόβλημα (π.χ. η σταδιακή προσέγγιση μίας συνάρτησης). Η μάθηση επιτυγχάνεται μέσω της εκπαίδευσης, μίας επαναληπτικής διαδικασίας σταδιακής προσαρμογής των παραμέτρων του δικτύου σε τιμές κατάλληλες ώστε να επιλύεται με επαρκή επιτυχία το προς εξέταση πρόβλημα.


Υπάρχουν πολλές κατηγορίες νευρωνικών δικτύων όπως τα Συνελικτικά Νευρωνικά Δίκτυα (Convolutional Neural Networks), τα Αναδρομικά Νευρωνικά Δίκτυα (Recurrent Neural Networks), τα Ακτινικά Νευρωνικά Δίκτυα (Radial Basis Networks), τα Πιθανοτικά Νευρωνικά Δίκτυα (Probabilistic Neural Networks) και άλλα, κάθε ένα κατάλληλο για διαφορετικό τύπο εφαρμογών. Εμείς θα χρησιμοποιήσουμε τα ακτινικά νευρωνικά δίκτυα τα οποία από εδώ και στο εξής θα αναφέρουμε ως \textit{δίκτυα RBF} καθώς είναι τα καταλληλότερα για προσέγγιση συναρτήσεων.

\subsection{Αρχιτεκτονική}
Η αρχιτεκτονική ενός RBF νευρωνικού δικτύου παρουσιάζεται στο σχήμα $(\ref{fig:rbf_network_architecture})$. Ένα RBF νευρωνικό δίκτυο αποτελείται από τρία επίπεδα, το επίπεδο εισόδου, το ενδιάμεσο ή κρυφό επίπεδο, και το επίπεδο εξόδου.

\begin{figure}
	\centering
	\input{./images/tikz/rbf_network.tex}
	\caption{ Αρχιτεκτονική Νευρωνικού Δικτύου RBF }
	\label{fig:rbf_network_architecture}
\end{figure}

\textbf{Επίπεδο Εισόδου}: Η είσοδος ενός δικτύου RBF είναι ένα διάνυσμα $x = \begin{bmatrix} x_1,x_2, ..., x_n \end{bmatrix}^T$. Στα νευρωνικά δίκτυα αυτής της κατηγορίας το επίπεδο εισόδου είναι υπεύθυνο για την μετάδοση των επιμέρους ορισμάτων $x_i$ σε κάθε νευρώνα και όχι για κάποια περαιτέρω προεπεξεργασία δεδομένων.

\textbf{Κρυφό Επίπεδο:} Στο κρυφό επίπεδο λαμβάνει χώρο ο υπολογισμός των συναρτήσεων $\varphi_i(x)$ οι οποίες ονομάζονται \textit{συναρτήσεις βάσης} ή \textit{συναρτήσεις ενεργοποίησης}. Σε άλλους τύπους δικτύων μπορεί να υπάρχουν πάνω από ένα κρυφά επίπεδα, αλλά στα RBF δίκτυα που μελετάμε υπάρχει μόνο ένα.

\begin{figure}
	\centering
	\input{plots/mathematicalTools/networks/simple_gaussian.tex}
	\caption{ Γκαουσιανή συνάρτηση ενεργοποίησης. Το κέντρο $c$ είναι το σημείο στο οποίο η συνάρτηση παρουσιάζει την μέγιστη τιμή, ενώ η διασπορά $\sigma$ καθορίζει τον ρυθμό που η συνάρτηση μειώνεται όσο το $x$ απομακρύνεται από το $c$. }
	\label{fig:gaussian_function}
\end{figure}

Κάθε συνάρτηση βάσης είναι μια πραγματική συνάρτηση $\varphi: \mathbb{R}^n \rightarrow \mathbb{R} $, και αντιστοιχεί σε ένα σημείο του χώρου $c \in \mathbb{R}^n$. Οι συναρτήσεις $\varphi$ είναι ακτινικές συναρτήσεις, που σημαίνει πως το αποτέλεσμα τους εξαρτάται από την απόσταση της εισόδου $x$ από το σημείο $c$, ή αλλιώς μαθηματικά:
\begin{equation*}
	\varphi(x,c) = \varphi(\| x - c \|)
\end{equation*}
και από εκεί προκύπτει και η ονομασία Ακτινικά Νευρωνικά Δίκτυα. Τυπικές ακτινικές συναρτήσεις είναι η γκαουσιανή, η τετραγωνική, η αντίστροφη τετραγωνική και άλλες~\cite{wiki:rbf}, ωστόσο σε αυτήν την εργασία θα χρησιμοποιήσουμε τις γκαουσιανές συναρτήσεις οι οποίες έχουν την μορφή
\begin{equation*}
	\varphi(x) = \exp \left( - \left\| \frac{x - c}{\sigma}\right\|^2 \right)
\end{equation*}
Το σημείο $c$ ονομάζεται \textit{κέντρο} ενώ η ποσότητα $\sigma$ ονομάζεται \textit{διασπορά}. Στην εφαρμογή μας, και τα δυο αυτά μεγέθη επιλέγονται εκ των προτέρων και παραμένουν σταθερά κατά την διάρκεια των πειραμάτων. Ένα παράδειγμα μιας μονοδιάστασης γκαουσιανής συνάρτησης φαίνεται στο σχήμα $(\ref{fig:gaussian_function})$.


\textbf{Επίπεδο Εξόδου:} Η έξοδος ενός RBF νευρωνικού δικτύου είναι μια βαθμωτή συνάρτηση $f: \mathbb{R}^n \rightarrow \mathbb{R} $. Η έξοδος αυτή υπολογίζεται στο επίπεδο εξόδου ώς το σταθμισμένο άθροισμα:
\begin{equation*}
	f(x) = \sum_{i = 1}^{N} w_i \varphi_i (x)
\end{equation*}
Τα βάρη $w_i$ ονομάζονται \textit{συναπτικά βάρη}, και αποτελούν τις ελεύθερες παραμέτρους του δικτύου. Καθώς οι συναρτήσεις βάσης $\varphi_i(x)$ είναι προεπιλεγμένες και σταθερές, λέμε ότι το μοντέλο είναι \textit{γραμμικά παραμετροποιημένο} που θα πει ότι η έξοδος του είναι γραμμικός συνδυασμός των ελεύθερων παραμέτρων αυτού. Τέλος, η έξοδος του μοντέλου μπορεί να γραφτεί και διανυσματικά ώς:
\begin{equation*}
	f(x) = \begin{bmatrix} w_1 & w_2 & ... & w_n \end{bmatrix} \cdot \begin{bmatrix}
	\varphi_1(x) \\ \varphi_2(x) \\ ... \\ \varphi_n(x)
	\end{bmatrix} = 
	W^T \cdot  \varPhi(x)
\end{equation*}
Το διάνυσμα $W$ ονομάζεται \textit{διάνυσμα βαρών} ενώ το διάνυσμα $\varPhi(x)$ ονομάζεται \textit{διάνυσμα οπισθοδρομητών} στην βιβλιογραφία της αναγνώρισης συστημάτων. Η γραμμικότητα ως προς τις ελεύθερες παραμέτρους αποτελεί σημαντικό πλεονέκτημα στα προβλήματα αναγνώρισης, για αυτό και τα γραμμικά παραμετροποίημενα μοντέλα προτιμούνται σε τέτοιου είδους εφαρμογές.



\subsection{Προσεγγιστικές Ιδιότητες} \label{subsec:rbf_approximation_theorem}
Τα ακτινικά νευρωνικά δίκτυα είναι ένα πολύ χρήσιμο εργαλείο στην αναγνώριση μη γραμμικών συστημάτων. Ο λόγος είναι πως η παραπάνω δομή μπορεί να προσεγγίσει ικανοποιητικά καλά μια οποιαδήποτε συνεχή συνάρτηση όπως αναφέρεται στην ακόλουθη ιδιότητα~\cite{park1991universal}.\\

\begin{theorem}[\textbf{Ιδιότητα Προσέγγισης}]
\textit{Για κάθε συνεχή συνάρτηση $f: \mathbb{R}^n \rightarrow \mathbb{R} $ και κάθε θετική σταθερά $\epsilon > 0$ υπάρχουν ακέραιος αριθμός $q$, βέλτιστα βάρη $W^* \in \mathbb{R}^q$ και διανυσματικό πεδίο βάσης $\varPhi: \mathbb{R}^n \rightarrow \mathbb{R}^q$, τέτοια ώστε:
\begin{equation*}
	\max_{x \in \Omega_x} \left\| f(x) - W^{*T}\varPhi(x) \right\| \leq \epsilon
\end{equation*}
όπου $\Omega_x$ είναι ένα συμπαγές σύνολο προσέγγισης.
}
\end{theorem}

Σύμφωνα με την παραπάνω ιδιότητα αν το μέγεθος του διανυσματικού πεδίου βάσης $q$ είναι αρκούντως μεγάλο και οι συναρτήσεις που περιλαμβάνει είναι κατάλληλα επιλεγμένες τότε υπάρχουν βέλτιστα βάρη $W^*$ τέτοια ώστε η έξοδος του νευρωνικού δικτύου να προσεγγίζει οσοδήποτε καλά την άγνωστη συνάρτηση $f(x)$ μέσα στο σύνολο $\Omega_x$. Ως εκ τούτου, μπορούμε να αντικαταστήσουμε, χωρίς βλάβη γενικότητας, την άγνωστη συνάρτηση $f(x)$ με ένα RBF νευρωνικό δίκτυο ως εξής:
\begin{equation*}
	f(x) = W^{*T}\varPhi(x) + \epsilon_f(x)
\end{equation*}

Η ποσότητα $\epsilon_f(x)$ ονομάζεται \textit{σφάλμα μοντελοποίησης}, και εξαρτάται από την αρχιτεκτονική του νευρωνικού δικτύου, δηλαδή το πλήθος και την διάταξη των συναρτήσεων βάσης και αντίστοιχα των κέντρων και των διασπορών του νευρωνικού δικτύου.

\begin{figure}
	\begin{subfigure}{0.5\textwidth}
		\input{plots/mathematicalTools/networks/components.tex}
		\caption{Επιμέρους όροι}
	\end{subfigure}
	\begin{subfigure}{0.5\textwidth}
		\input{plots/mathematicalTools/networks/f_approximation.tex}
		\caption{Συνολική Προσέγγιση}
	\end{subfigure}
	\caption{ Προσέγγιση της $f(x) = 1+x$ από ένα απλό RBF νευρωνικό δίκτυο. }
	\label{fig:rbf_approximation}
\end{figure}


\textbf{Παράδειγμα}\\
Στο παράδειγμα που ακολουθεί, θα γίνει μια επίδειξη των προσεγγιστικών ικανοτήτων ενός RBF νευρωνικού δικτύου. Για λόγους απλότητας θα προσεγγίσουμε την μονοδιάστατη συνάρτηση $f: \mathbb{R} \rightarrow \mathbb{R} $
\begin{equation*}
f(x) = 1+x
\end{equation*}
στο συμπαγές σύνολο $\Omega_x = [-1,1] \subset \mathbb{R}$. Για την προσέγγιση θα χρησιμοποιήσουμε ένα νευρωνικό δίκτυο RBF με τρία κέντρα κατανεμημένα στο $\Omega_x$. Τα κέντρα αυτά θα είναι τα $c = \begin{bmatrix} -0.7 & 0.0 & 0.7 \end{bmatrix}$ και η διασπορά $\sigma$ είναι $0.4$. 

{
\begin{wrapfigure}{r}{0.4\textwidth}
	\centering
	\input{plots/mathematicalTools/networks/f_approximation_dense.tex}
	\caption{Προσέγγιση με πυκνότερο δίκτυο}
	\label{fig:rbf_dense_approximation}	
\end{wrapfigure}

Τα αποτελέσματα της προσέγγισης φαίνονται στο σχήμα $(\ref{fig:rbf_approximation})$. Αρχικά στο σχήμα $(\ref{fig:rbf_approximation}.a)$ φαίνονται τα βέλτιστα βάρη για κάθε μια από τις συναρτήσεις βάσης, και το άθροισμα τους το οποίο αποτελεί την προσέγγιση $\hat{f}(x)$ φαίνεται στο σχήμα $(\ref{fig:rbf_approximation}.b)$. 

Όπως φαίνεται λοιπόν από το σχήμα $(\ref{fig:rbf_approximation}.b)$, το εκπαιδευμένο νευρωνικό δίκτυο καταφέρνει να προσεγγίσει ικανοποιητικά την άγνωστη συνάρτηση στην περιοχή ενδιαφέροντος $\Omega_x$. Το σφάλμα μοντελοποίησης $\epsilon_f(x)$ είναι η σκιαγραφημένη περιοχή, ενώ στο σχήμα φαίνεται και το μέγιστο σφάλμα $\epsilon$. Καθώς αυτό το σφάλμα είναι το ελάχιστο δυνατό για την δεδομένη αρχιτεκτονική που έχουμε επιλέξει, στην περίπτωση που απαιτείται μεγαλύτερη ακρίβεια, πρέπει να αυξήσουμε τον αριθμό των συναρτήσεων βάσης. Μια προσέγγιση με την χρήση ενός πυκνότερου δικτύου φαίνεται στο σχήμα $(\ref{fig:rbf_dense_approximation})$

}

Τέλος, είναι σημαντικό να σημειωθεί πως το θεώρημα μας εξασφαλίζει πως το σφάλμα $\epsilon_f(x)$ φράσσεται από το $\epsilon$ μόνο εντός του $\Omega_x$. Όπως φαίνεται και στο σχήμα $(\ref{fig:rbf_approximation}.b)$, όσο απομακρυνόμαστε από το $\Omega_x$ το σφάλμα μεγαλώνει ανεξέλεγκτα.


\section{Συνθήκη Επιμένουσας Διέγερσης}
Όπως είδαμε στο κεφάλαιο $2.1$, μπορούμε να χρησιμοποιήσουμε το μαθηματικό μοντέλο των νευρωνικών δικτύων $RBF$ για να προσεγγίσουμε αρκούντως καλά μια συνεχή μη-γραμμική συνάρτηση σε ένα πεδίο ενδιαφέροντος $\Omega_x$. Πώς όμως εξασφαλίζεται ότι τα βάρη $W$ θα συγκλίνουν στα βέλτιστα βάρη $W^*$ κατά την εκτίμηση παραμέτρων;

Η απάντηση στο παραπάνω ερώτημα δίνεται από την \textit{Συνθήκη της Επιμένουσας Διέγερσης (Persistancy of Excitation Condition)}, η οποία δίνεται παρακάτω:\\

\begin{definition}[\textbf{Συνθήκη Επιμένουσας Διέγερσης}]
	Έστω $\mu$ ένα θετικό $\Sigma$-πεπερασμένο μέτρο Borel στο διάστημα $[0,\infty)$. Μια συνεχής, ομοιόμορφα φραγμένη διανυσματική συνάρτηση $\varPhi: [0,\infty) \rightarrow \mathbb{R}^q$ ικανοποιεί την συνθήκη Επιμένουσας Διέγερσης εάν υπάρχουν θετικές σταθερές $a_1$, $a_2$ και $T$ έτσι ώστε:
	\begin{equation}
	a_1 \left\| W \right\|^2 
	\leq
	\int_{t_0}^{t_0 + T} \left| W^T \varPhi(\tau) \right|^2 d\mu(\tau) 
	\leq
	a_2 \left\| W \right\|^2, \quad
	\forall \: t_0 \geq 0 , \quad
	\forall \: W \in \mathbb{R}^q
	\label{eq:pe_condition}
	\end{equation}
\end{definition}

Διαισθητικά το παραπάνω θεώρημα θα πει πως η συνθήκη επιμένουσας διέγερσης ικανοποιείται όταν η τροχιά του συστήματος εξερευνεί πλήρως τον χώρο ελεύθερων παραμέτρων. Η παρακάτω έννοια θα εξηγηθεί και στην συνέχεια με παραδείγματα.\\

%\textbf{Παρατήρηση 1:} 

\begin{remark}
	Στην παραπάνω εξίσωση, οι σταθερές $a_1$ και $a_2$ ονομάζονται επίπεδα διέγερσης, και οι τιμές τους είναι καθοριστικές για την απόδοση των αλγορίθμων αναγνώρισης (ρυθμός σύγκλισης, άνω φράγματα σφαλμάτων). Ωστόσο, το παραπάνω Θεώρημα είναι θεώρημα ύπαρξης αυτών των τιμών, και όχι υπολογισμού τους.\\
\end{remark}

\begin{remark}
	Ο λόγος που το διάνυσμα οπισθοδρομητών $\varPhi(x)$ εμφανίζεται στην παραπάνω εξίσωση ως συνάρτηση του χρόνου $t$ είναι επειδή στην πράξη, το διάνυσμα καταστάσεων $x(t)$ είναι μια καμπύλη $x: [0,\infty) \rightarrow \mathbb{R}^n$. Η ικανοποίηση της ΣΕΔ στις εφαρμογές \textit{οnline} αναγνώρισης συστημάτων ανάγεται ακριβώς στο πρόβλημα της σχεδίασης ενός ελεγκτή που επιτυγχάνει την παρακολούθηση μιας τροχιάς η οποία διεγείρει επαρκώς την δυναμική συστήματος.\\
\end{remark}

\begin{remark} 
	Η ισχύς του παραπάνω θεωρήματος είναι γενική και δεν ισχύει μόνο για το μοντέλο των RBF νευρωνικών δικτύων. Εν αντιθέσει, το θεώρημα δεν θέτει κανέναν περιορισμό για την δομή του διανύσματος οπισθοδρομητών $\varPhi(\tau)$, συνεπώς οποιαδήποτε επιλογή μοντέλου και σετ δεδομένων $x(t)$ μπορούν να χρησιμοποιηθούν.\\
\end{remark}

\begin{remark}
	Είναι σημαντικό να τονίσουμε πως η ΣΕΔ το μόνο που εξασφαλίζει είναι ότι τα βέλτιστα βάρη για το επιλεγμένο μοντέλο μπορούν να βρεθούν. Αυτό δεν συνεπάγεται απαραίτητα ότι το μοντέλο αυτό είναι ικανό να προσεγγίσει επαρκώς την δυναμική του συστήματος (Παράδειγμα 2).
\end{remark}

\subsection{Παράδειγμα 1: Μη ικανοποίηση της Σ.Ε.Δ}
Έστω ότι θέλουμε να προσεγγίσουμε την άγνωστη συνάρτηση $f(x) = \sqrt{x}$ στο κλειστό σύνολο $\Omega_x = [0,2]$. Για τον σκοπό αυτό, θα χρησιμοποιήσουμε δυο συναρτήσεις ράμπα τοποθετημένες στο $x=0$ και στο $x=1$. Καθώς η συνάρτηση ράμπα περιγράφεται από τον παρακάτω τύπο
\begin{equation*}
	R_i(x) = \begin{cases}
	x-i \:&, x \geq i\\
	0 \: &, x<i 
	\end{cases}
\end{equation*}
το μαθηματικό μοντέλο που χρησιμοποιούμε είναι το:
\begin{equation}
y = a R_0(x) + b R_1(x)
\label{eq:ramp_model}
\end{equation}
όπου $a$ και $b$ οι ελεύθεροι παράμετροι. Χρησιμοποιώντας αυτό το μοντέλο, η βέλτιστη δυνατή προσέγγιση φαίνεται στο σχήμα $(\ref{fig:sqrt_approximation})$.

\begin{figure}
	\centering
	\scalebox{1}{\input{plots/mathematicalTools/pe/sqrt_approx.tex}}
	\caption{ Προσέγγιση της $\sqrt{x}$ από ράμπες}
	\label{fig:sqrt_approximation}
\end{figure}

\subsubsection{Διαισθητική Ερμηνεία}
Με την φράση \emph{"η τροχιά του συστήματος εξερευνεί πλήρως τον χώρο ελεύθερων παραμέτρων"} εννοούμε πως κατά την διάρκεια συλλογής δεδομένων, ανεξαρτήτως του αν ο αλγόριθμος είναι online ή offline, πρέπει η τροχιά $x(t)$ να διεγείρει όλες τις συνιστώσες του διανύσματος οπισθοδρομητών.

Στο συγκεκριμένο παράδειγμα, το διάνυσμα οπισθοδρομητών είναι το
\begin{equation*}
	\varPhi(x(t)) = \begin{bmatrix}
	R_0(x(t)) \\ R_1(x(t)) 
	\end{bmatrix}
\end{equation*}
Εάν κατά την διάρκεια εκτέλεσης ενός πειράματος αναγνώρισης, η τροχιά $x(t)$ ανήκει εξολοκλήρου στο σύνολο $\Omega_1$ (σχήμα \ref{fig:sqrt_approximation}), τότε η εκτίμηση $\hat{f}(x)$ εκφυλίζεται σε:
\begin{equation*}
\begin{split}
\hat{f}(x) &=\begin{bmatrix} a & b \end{bmatrix} 
\begin{bmatrix} R_0(x) \\ R_1(x) \end{bmatrix} \xRightarrow{x \in \Omega_1}\\
&= a R_0(x)
\end{split}
\end{equation*}
και κατά συνέπεια η παράμετρος $b$ δεν επηρεάζει καθόλου το αποτέλεσμα. Συνεπώς, κανένας αλγόριθμος εκτίμησης παραμέτρων δεν μπορεί να εκτιμήσει σωστά αυτή την παράμετρο με αποτέλεσμα την αποτυχία του πειράματος αναγνώρισης.




\subsubsection{Μαθηματική Απόδειξη}
Αρχικά, ας εξετάσουμε την σχέση $(\ref{eq:pe_condition})$. Χρησιμοποιώντας τον γεωμετρικό ορισμό του εσωτερικού γινομένου για τον όρο $W^T \varPhi(x(t))$ έχουμε
\begin{equation*}
\begin{split}
a_1 \left\| W \right\|^2  &\leq
\int_{t_0}^{t_0 + T} \left| W^T \varPhi(\tau) \right|^2 d\mu(\tau) 
\leq
a_2 \left\| W \right\|^2
\xRightarrow{a^T \cdot b = \| a\| \|b \| \cos{\theta}}\\
% Second Line
a_1  \cancel{\left\| W \right\|^2} &\leq % left
\cancel{\left\| W \right\|^2}  
\int_{t_0}^{t_0 + T} \left\| \varPhi(\tau) \right\|^2 \cos^2(\theta) d\mu(\tau) \leq % middle
a_2 \cancel{\left\| W \right\|^2} \Rightarrow \\ %right
a_1 &\leq
\int_{t_0}^{t_0 + T} \left\| \varPhi(\tau) \right\|^2 \cos^2(\theta) d\mu(\tau)
\leq a_2, \quad \text{όπου} \: \theta = \angle (W, \varPhi(\tau))
\end{split}
\end{equation*}
Καθώς το διάνυσμα $W$ μπορεί να είναι οποιοδήποτε διάνυσμα του χώρου $\mathbb{R}^q$, η γωνία $\theta$ της παραπάνω εξίσωσης πρακτικά είναι η γωνία του διανύσματος οπισθοδρομητών $\varPhi(x(t))$ με οποιοδήποτε μοναδιαίο διάνυσμα $c$ στον χώρο $\mathbb{R}^q$. Συνεπώς, η παραπάνω σχέση γράφεται αλλιώς και ως:
\begin{equation}
	a_1 \leq \int_{t_0}^{t_0 + T} \left\| c^T \varPhi(\tau) \right\|^2 d\mu(\tau)
	\leq a_2, \quad
	\forall \: t_0 \geq 0 , \quad
	\| c \| = 1
	\label{eq:pe_alternative}
\end{equation}
για κάθε μοναδιαίο διάνυσμα του χώρου $\mathbb{R}^q$. Η εξίσωση $(\ref{eq:pe_alternative})$ αποτελεί μια ισοδύναμη έκφραση της Συνθήκης Επιμένουσας Διέγερσης, η οποία σε αυτό το παράδειγμα διευκολύνει την ανάλυση.

\begin{figure}
	\centering
	\scalebox{1}{\input{plots/mathematicalTools/pe/regressor_path.tex}}
	\caption{ Γεωμετρικός τόπος του $\varPhi(x)$ στο $\Omega$}
	\label{fig:regressor_locus}
\end{figure}

Επιστρέφοντας στο παράδειγμα μας, έστω ότι έχουμε βρει έναν μηχανισμό ελέγχου που εξαναγκάζει την τροχιά $x(t)$ του συστήματος να εκτελέσει την περιοδική κίνηση
\begin{equation*}
x(t) = 0.5(1+\cos(t))
\end{equation*}
συνεπώς ισχύει η ανίσωση: $ 0 \leq x(t) \leq 1$, και άρα $x(t) \in \Omega_1$.

Καθώς η συνάρτηση $x(t)$ είναι περιοδική με περίοδο $2\pi$, έτσι και η συνάρτηση $c^T \varPhi(x(t))$ της εξίσωσης $(\ref{eq:pe_alternative})$, ως σύνθεση με περιοδική συνάρτηση είναι επίσης περιοδική. Έτσι, επιλέγοντας στην εξίσωση \eqref{eq:pe_condition} την σταθερά $T$ ίση με την περίοδο, μπορούμε να χρησιμοποιήσουμε την παρακάτω ιδιότητα των περιοδικών συναρτήσεων:
\begin{equation*}
	\int_{a}^{a+T} f(x) dx = \int_{0}^{T} f(x) dx
\end{equation*}
για να απλοποιήσουμε περαιτέρω το ολοκλήρωμα της ΣΕΔ ως εξής:
\begin{equation*}
\int_{t_0}^{t_0 + T} \left| c^T \varPhi(x(\tau)) \right|^2 d\tau = 
\int_{0}^{T} \left| c^T \varPhi(x(\tau)) \right|^2 d\tau, \quad \forall t_0
\end{equation*}
Από την παραπάνω σχέση, είναι ευκολότερο να αντιληφθεί κανείς την φυσική σημασία της ΣΕΔ. Πρέπει, κατά μήκος μιας περιόδου το διάνυσμα $\varPhi(x(t))$ να εξερευνεί κάθε κατεύθυνση $c$ του χώρου ελεύθερων παραμέτρων. Όσο πιο αποτελεσματική είναι η διέγερση αυτή, τότε τόσο αυξάνεται το κάτω φράγμα $a_1$ το οποίο ονομάζεται και \textit{επίπεδο διέγερσης}.

Για να επιδείξουμε το παραπάνω συμπέρασμα, στο σχήμα $(\ref{fig:regressor_locus})$ μελετάμε την γεωμετρική συμπεριφορά του διανύσματος $\varPhi(x(t))$ συναρτήσει της τροχιάς $x(t)$. Καθότι έχουμε συναρτήσεις ράμπας, το διάνυσμα γράφεται ώς:
\begin{equation*}
	\varPhi(x) = 
	\begin{cases}
	[x, 0]^T    &, \: x \in \Omega_1\\
	[x,x-1]^T &, \: x \in \Omega_2\\
	\end{cases}
\end{equation*}
Όταν η τροχιά $x(t) \in \Omega_1$, τότε το διάνυσμα $\varPhi$ κινείται πάνω στο πορτοκαλί ευθύγραμμο τμήμα. Σε αυτή την περίπτωση όμως, είναι πάντα κάθετο στο μοναδιαίο διάνυσμα $c = [ 1 \: 0 ]^T$, συνεπώς το εσωτερικό γινόμενο $c^T \varPhi(x(\tau))$ είναι $0$ καθ'όλη την διάρκεια της περιόδου. 

Μέσω αυτού του αντιπαραδείγματος βλέπουμε πως δεν υπάρχει θετικό $a_1$ που να ικανοποιεί την παρακάτω σχέση.
\begin{equation*}
	0 < a_1 \leq \int_{0}^{T} \left| c^T \varPhi(x(\tau)) \right|^2 d\tau \quad
	\forall c \in
	\{c \mid c \in \mathbb{R}^2, \: \|c\| =1 \}
\end{equation*}
συνεπώς η διανυσματική συνάρτηση $\varPhi$ δεν ικανοποιεί την συνθήκη επιμένουσας διέγερσης.

Αντιθέτως, μέσω του σχήματος $(\ref{fig:regressor_locus})$ βλέπουμε πως εάν επιλέξουμε μια τροχιά $x(t)$ που να επισκέπτεται και τα δύο σύνολα $\Omega_1$ και $\Omega_2$, τότε το διάνυσμα $\varPhi$ κινείται πάνω στα δύο ευθύγραμμα τμήματα (πορτοκαλί και μπλέ). Σε αυτή την περίπτωση δεν υπάρχει διάνυσμα $c$ του μοναδιαίου κύκλου που να είναι κάθετο σε όλη την διάρκεια της περιόδου $T$, συνεπώς ικανοποιείται η συνθήκη επιμένουσας διέγερσης.

Παρόλα αυτά, ακόμα και σε αυτό το απλό παράδειγμα είναι αρκετά δύσκολος ο αναλυτικός υπολογισμός του επιπέδου διέγερσης $a_1$.

\subsection{Παράδειγμα 2: Σ.Ε.Δ και ποιότητα εκτίμησης}
Σε αυτό το δεύτερο παράδειγμα το ζητούμενο μας είναι η προσέγγιση της άγνωστης συνάρτησης $f(x) = 1 + 0.3\cos(5x)$ με την χρήση του μοντέλου
\begin{equation*}
	y = a \cos(x) + b \sin(x)
\end{equation*}

Όπως και πριν, έτσι και εδώ θα υποθέσουμε πως έχουμε βρει έναν μηχανισμό ελέγχου που εξαναγκάζει την τροχιά $x(t)$ του συστήματος να εκτελέσει την κίνηση $x(t) = t$. Παρόλο που η κίνηση δεν είναι περιοδική όπως πριν, αυτό δεν αποτελεί πρόβλημα αφού τόσο η άγνωστη συνάρτηση $f$, όσο και το διάνυσμα οπισθοδρομητών $\varPhi$ είναι περιοδικές συναρτήσεις του χρόνου.

\subsubsection{Μαθηματική Ανάλυση}
Ας εξετάσουμε την ΣΕΔ για το συγκεκριμένο παράδειγμα χρησιμοποιώντας τον ορισμό της εξίσωσης $(\ref{eq:pe_alternative})$. Ομοίως με πριν, το διάνυσμα οπισθοδρομητών είναι περιοδικό με περίοδο $2\pi$, συνεπώς ο υπολογισμός της ΣΕΔ ανάγεται στην μελέτη του ολοκληρώματος
\begin{equation*}
	\int_{0}^{T} \left| c^T \varPhi(x(\tau)) \right|^2 d\tau, \quad
	\forall c \in
	\{c \mid c \in \mathbb{R}^2, \: \|c\| =1 \}
\end{equation*}

Αναλύοντας το εσωτερικό γινόμενο $c^T \varPhi(x(\tau))$ περαιτέρω, προκύπτει
\begin{equation}
\int_{0}^{T} \left| c^T \varPhi(x(\tau)) \right|^2 d\tau = 
\int_{0}^{T} \|c\|^2 \| \varPhi(x(\tau)) \|^2 \cos^2(\theta) d\tau, \quad
\text{όπου} \: \theta = \angle (c, \varPhi(\tau))
%\forall c \in
%\{c \mid c \in \mathbb{R}^2, \: \|c\| =1 \}
\label{eq:pe_sines}
\end{equation}
Καθώς όμως, το $c$ είναι μοναδιαίο, το μέτρο του είναι $1$. Επίσης, το διάνυσμα οπισθοδρομητών είναι το
\begin{equation*}
	\varPhi(x) = \begin{bmatrix} \cos(x) \\ \sin(x) \end{bmatrix}
\end{equation*}
το μέτρο  $\| \varPhi(x(\tau)) \|$ είναι επίσης $1$ για κάθε $x$. Συνεπώς το ολοκλήρωμα της σχέσης $(\ref{eq:pe_sines})$ απλοποιείται ακόμα περισσότερο και τελικά καταλήγουμε στην τελική μορφή:
\begin{equation*}
	\int_{0}^{T}\cos^2(\theta(t)) d\tau
\end{equation*}
{
\begin{wrapfigure}{r}{0.4\textwidth}
	\centering
	\includegraphics[scale=0.8]{plots/mathematicalTools/pe/regressors_sine.tex}
	\caption{}
	\label{fig:regressors_theta}	
\end{wrapfigure}
όπου η γωνία $\theta(t)$ δίνεται από την σχέση
\begin{equation*}
	\theta(t) = \theta_{\varPhi}(t) - \theta_c ,
	\quad \theta_c \in [0,2\pi]
\end{equation*}
με τα $\theta_{\varPhi}$ και $\theta_c$ να φαίνονται στο σχήμα $(\ref{fig:regressors_theta})$. Λόγω της συμμετρίας του σχήματος, το αποτέλεσμα θα είναι το ίδιο για κάθε γωνία $\theta_c$, και συνεπώς η αριθμητική τιμή του ολοκληρώματος της ΣΕΔ είναι τελικά
\begin{equation*}
\int_{0}^{2\pi}\cos^2(\tau) d\tau = \pi = a_1 = a_2
\end{equation*}

Όπως μπορούμε να δούμε η απλότητα του παραδείγματος μας επιτρέπει τον ακριβή υπολογισμό των επιπέδων διέγερσης και ως εκ τούτου την μαθηματική επαλήθευση της ΣΕΔ.

}

Παρόλα αυτά, χρησιμοποιώντας το παραπάνω μοντέλο για να προσεγγίσουμε την άγνωστη $f(x)$ στο πεδίο ενδιαφέροντος, καταλήγουμε στην προσέγγιση του σχήματος $(\ref{fig:sines_approximation})$ η οποία δεν είναι ιδιαίτερα ικανοποιητική.

\begin{figure}[h!]
\centering
\input{plots/mathematicalTools/pe/sines_approximation.tex}
\caption{ Προσέγγιση της $f(x)$ του Παραδείγματος $2$. }
\label{fig:sines_approximation}
\end{figure}

\pagebreak
Το συμπέρασμα που προσπαθούμε να καταλήξουμε μέσω αυτού του παραδείγματος είναι πως ακόμα και αν η ΣΕΔ ικανοποιείται, αυτό δεν συνεπάγεται υποχρεωτικά στην επιτυχία της εφαρμογής αναγνώρισης. Πρέπει και το μοντέλο που χρησιμοποιείται να είναι ικανό να προσεγγίσει την ικανοποιητικά την άγνωστη συνάρτηση.

\subsection{ΣΕΔ για RBF νευρωνικά δίκτυα} \label{subsec:rbf_PE}
Όπως είδαμε, η μαθηματική εξασφάλιση της ικανοποίησης της Συνθήκης Επιμένουσας Διέγερσης είναι αρκετά πολύπλοκη, ακόμα και σε πολύ απλές εφαρμογές όπως αυτές των Παραδειγμάτων $1$ και $2$. 

Καθώς στην εργασία αυτή χρησιμοποιούμε ως μοντέλα τα RBF νευρωνικά δίκτυα, σε αυτό το κεφάλαιο παρουσιάζουμε ένα αποτέλεσμα που μας επιτρέπει να εγγυηθούμε την ικανοποίηση της ΣΕΔ σε ένα τόσο σύνθετο πρόβλημα.\\

\begin{theorem} [\textbf{ΣΕΔ για δίκτυα RBF}]
\textit{Έστω το σύνολο $I = [t_0, t_0 + T]$, όπου $t_0$ και $T$
θετικές σταθερές, και τα σύνολα $I_i = \{ t \in I :  \| x(t) - c_i \| \} \leq \epsilon, \: i = 1,\dots, q $ με το $\epsilon \leq \frac{1}{2} \min_{i \neq j} \{\| c_i - c_j \| \}$. Εάν υπάρχει σταθερά $T$ έτσι ώστε τα μέτρα $\mu(I_i)$ να είναι κάτω φραγμένο από μια σταθερά $\tau_0$ που είναι ανεξάρτητη του $t_0$ και του $i$, τότε το διάνυσμα οπισθοδρομητών $\varPhi(x(t))$ ικανοποιεί την συνθήκη επιμένουσας διέγερσης της εξίσωσης $(\ref{eq:pe_condition})$.}
\end{theorem}

\subsubsection{Φυσική Σημασία}
Η ερμηνεία του παραπάνω θεωρήματος είναι η εξής: Εάν εντός μιας περιόδου $T$, για κάθε κέντρο $c_i$ υπάρχει ένα χρονικό διάστημα $I_i$ στο οποίο η τροχιά $x(t)$ διέρχεται αρκούντως κοντά από αυτό, και ο χρόνος $\mu (I_i)$ που παραμένει αρκούντως κοντά είναι πάντα μεγαλύτερος από μια σταθερά $\tau_0$, τότε το διανυσματικό πεδίο $\varPhi(x(t))$ ικανοποιεί την ΣΕΔ της εξίσωσης $(\ref{eq:pe_condition})$.

Με αυτόν τον τρόπο, κάθε συνάρτηση ενεργοποίησης $\varphi_i(x(t))$ φτάνει κοντά στην μέγιστη τιμή της τουλάχιστον μια φορά εντός κάθε περιόδου, διεγείροντας έτσι την αντίστοιχη μοναδιαία κατεύθυνση $c$ του χώρου ελεύθερων παραμέτρων $\mathbb{R}^q$.

%ίσως μπορώ να βαλω ενα σχήμα εδω... (will see)

\section{Έλεγχος Προδιαγεγραμμένης Απόκρισης} \label{sec:ppc_introduction}
Ο Έλεγχος Προδιαγεγραμμένης Απόκρισης (Prescribed Performance Control) είναι μια μεθοδολογία ελέγχου που μας επιτρέπει να ελέγξουμε ένα συνεχές δυναμικό σύστημα, εφόσον αυτό ικανοποιεί κάποιες συνθήκες που θα διατυπωθούν παρακάτω. Το μεγάλο πλεονέκτημα αυτής της μεθοδολογίας είναι ότι εγγυάται πως το σφάλμα παρακολούθησης εξόδου θα συγκλίνει σε μια προαποφασισμένη και οσοδήποτε μικρή περιοχή του μηδενός με προεπιλεγμένη ταχύτητα και υπερύψωση.

Ο έλεγχος Προδιαγεγραμμένης Απόκρισης εισήχθη στην εργασία~\cite{bechlioulis2008robust} το 2008, και τα τελευταία χρόνια έχει αναπτυχθεί εκτεταμένα. Παρόλο που στις εργασίες αυτές έχουν αναπτυχθεί πολλές παραλλαγές που να εξασφαλίζουν προδιαγεγραμμένη απόκριση εξόδου σε strict feedback συστήματα~\cite{bechlioulis2009adaptive}, pure feedback συστήματα~\cite{bechlioulis2014low} και άλλα, σε αυτό το κεφάλαιο θα παρουσιάσουμε την βασική ιδέα της μεθόδου. Στο κεφάλαιο 3 θα εμβαθύνουμε παρουσιάζοντας έναν συγκεκριμένο τρόπο εφαρμογής της που να εξυπηρετεί τις ανάγκες του προβλήματος μας, και θα αποδείξουμε μαθηματικά την ορθότητα του.

\subsection{Ορισμός του προβλήματος}
Έστω ένα γενικό μη γραμμικό σύστημα της μορφής 
\begin{equation}
\begin{split}
\dot{x} &= f(x,u,t) \\
y &= h(x)
\end{split}
\label{eq:general_nonlinear_sys}
\end{equation}
όπου $x \in \mathbb{R}^n$ το διάνυσμα καταστάσεων, $ u\in \mathbb{R}^m$ το διάνυσμα εισόδων ελέγχου και $y \in \mathbb{R}^p$ είναι η έξοδος του συστήματος. Τα διανυσματικά πεδία $f: \mathbb{R}^n \times \mathbb{R}^m \times \mathbb{R}^+ \rightarrow \mathbb{R}^n$ και $h:\mathbb{R}^n \rightarrow \mathbb{R}^p$ είναι τοπικά Lipschitz συνεχή στα ορίσματά τους. Έστω επίσης και η αρκούντως ομαλή και φραγμένη τροχιά παρακολούθησης
\begin{equation*}
	y_d(t) = \begin{bmatrix}
		y_{d1}(t) & y_{d2}(t) & \cdots & y_{dp}(t)
	\end{bmatrix}^T
\end{equation*}
καθώς και τα αντίστοιχα σφάλματα εξόδου:
\begin{equation*}
	e_i(t) = y_i(t) - y_{di}(t), \quad i = 1,\dots ,p
\end{equation*}
Αυτό που επιδιώκουμε είναι η σύγκλιση των σφαλμάτων $e_i$ σε μια προαποφασισμένη και οσοδήποτε μικρή περιοχή του μηδενός με προεπιλεγμένη ταχύτητα σύγκλισης και υπερύψωση.

Το πρώτο βήμα είναι η μαθηματική περιγραφή των εννοιών αυτών. Για τον σκοπό αυτό ορίζουμε τις συναρτήσεις επίδοσης:\\

\begin{definition}[\textbf{Συνάρτηση Επίδοσης}]
	Μια συνάρτηση $\rho: \mathbb{R}^+ \rightarrow \mathbb{R}^+$ καλείται συνάρτηση επίδοσης εάν είναι φραγμένη, θετική, γνησίως φθίνουσα και ικανοποιεί τη σχέση:
	\begin{equation*}
	\lim\limits_{t \rightarrow \infty} \rho(t) > 0
	\end{equation*} 
\end{definition} 

Μια τυπική επιλογή συνάρτησης συμμετοχής είναι η συνάρτηση
\begin{equation}
	\rho(t) = ( \rho_0 - \rho_{\infty} ) e^{-\lambda t} + \rho_{\infty}
	\label{eq:exp_perf}
\end{equation}
Ο λόγος είναι πως η παραπάνω επιλογή μας επιτρέπει να διαμορφώσουμε το σφάλμα σταθερής κατάστασης επιλέγοντας το $\rho_{\infty}$, το αρχικό σφάλμα επιλέγοντας το $\rho_0$ και τον ρυθμό σύγκλισης επιλέγοντας το $\lambda$.

Στην συνέχεια, για να μοντελοποιήσουμε την υπερύψωση, ορίζουμε τους αριθμούς $\overline{M}_i$ και $\barbelow{M}_i$ ώς
\begin{equation}
	(\barbelow{M}_i, \overline{M}_i) = 
	\begin{cases}
	(-M_i ,1) \quad &\text{όταν} \quad e_i(0) > 0 \\
	(-1 ,M_i) \quad &\text{όταν} \quad e_i(0) < 0 
	\end{cases}
	\quad i = 1,\dots ,p
	\label{eq:ppc_overshoot}
\end{equation}
και το συνολικό πρόβλημα της Προδιαγεγραμμένης Απόκρισης Εξόδου (ΠΑΕ) περιγράφεται από τις εξισώσεις:
\begin{equation}
	\barbelow{M}_i \rho_i(t) < e_i(t) < \overline{M}_i \rho_i(t),
	\: \forall t \geq 0, \: i = 1,\dots ,p
	\label{eq:prescibred_performance}
\end{equation}


\begin{figure}
	\centering
	\input{plots/mathematicalTools/ppc/perf_functions.tex}
	\caption{Μαθηματική περιγραφή της Προδιαγεγραμμένης Απόκρισης}
	\label{fig:ppc_illustration}
\end{figure}


Η ανίσωση $(\ref{eq:prescibred_performance})$ περιγράφεται σχηματικά στην γραφική παράσταση $(\ref{fig:ppc_illustration})$. Όπως μπορούμε να δούμε το πλάτος της τελικής ζώνης σύγκλισης καθορίζεται από την σταθερά $\rho_{i \infty}$ της εξίσωσης $(\ref{eq:exp_perf})$ ενώ ο ρυθμός σύγκλισης σε αυτή την ζώνη από την αντίστοιχη σταθερά $\lambda_i$. 

Ο λόγος που τα όρια $\overline{M}_i$ και $\barbelow{M}_i$ καθορίζονται με βάση την εξίσωση $(\ref{eq:ppc_overshoot})$ είναι επειδή όταν το αρχικό σφάλμα $e_i$ είναι θετικό, περιμένουμε υπερύψωση στα αρνητικά και αντίστοιχα στα θετικά στην περίπτωση που το $e_i$ είναι αρνητικό. Πολλαπλασιάζοντας και τα δύο άκρα με την σταθερά $M_i$ το μόνο που επιτυγχάνεται είναι η κλιμάκωση (scale) της συνάρτησης επίδοσης, ενώ χρησιμοποιώντας την εξίσωση $(\ref{eq:ppc_overshoot})$ μπορούμε να επιβάλουμε μέγιστη υπερύψωση ίση με $M_i \rho_{i0}$. Μάλιστα, εάν επιλέξουμε $M_i = 0$ είναι εφικτή και η περιγραφή της μηδενικής υπερύψωσης.

Τέλος, είναι πολύ σημαντικό να τονίσουμε πως για να ισχύει η εξίσωση $(\ref{eq:prescibred_performance})$ για κάθε $t \geq 0$ πρέπει η τιμή $\rho_{i0}$ να είναι μεγαλύτερη από το πλάτος του αρχικού σφάλματος $| e_{i}(0) |$ αλλιώς για $t = 0$ το σφάλμα βρίσκεται έξω από την ζώνη.

Με βάση τα παραπάνω λοιπόν, το πρόβλημα της Προδιαγεγραμμένης Απόκρισης Εξόδου (ΠΑΕ) ορίζεται ώς εξής: 

\textbf{Πρόβλημα ΠΑΕ:}
\textit{ Να σχεδιαστεί μια συνεχής είσοδος ελέγχου $u$ για το σύστημα $(\ref{eq:general_nonlinear_sys})$ έτσι ώστε όλα τα σήματα κλειστού βρόχου να διατηρούνται φραγμένα και τα σφάλματα εξόδου $e_i(t), \: i = 1,\dots ,p$ να ικανοποιούν τις σχέσεις:
\begin{equation}
	\barbelow{M}_i' \rho_i(t) \leq e_i(t) \leq \overline{M}_i'  \rho_i(t),
	\: \forall t \geq 0, \: i = 1,\dots ,p
	\label{eq:ppc_problem_definition}
\end{equation}
για κάποιες σταθερές $\barbelow{M}_i'$ και $\overline{M}_i'$ για τις οποίες ισχύουν:
\begin{equation*}
	\barbelow{M}_i < \barbelow{M}_i' \leq \overline{M}_i' < \overline{M}_i, \: i = 1,\dots ,p
\end{equation*}
με τα $\barbelow{M}_i$ και $\overline{M}_i$ να ορίζονται από την σχέση $(\ref{eq:ppc_overshoot})$ και $\rho_i(t), \: i = 1,\dots ,p$ κατάλληλα επιλεγμένες συναρτήσεις επίδοσης.
}

\subsection{Μετασχηματισμός σε πρόβλημα σταθεροποίησης}
Καθώς το πρόβλημα ΠΑΕ στην μορφή της εξίσωσης $(\ref{eq:ppc_problem_definition})$ είναι αρκετά δύσκολο να αντιμετωπιστεί, παρακάτω θα παρουσιαστεί ένας μετασχηματισμός των σφαλμάτων εξόδου, ο οποίος τα διαμορφώνει αναφορικά με τα χαρακτηριστικά απόκρισης της εξίσωσης $(\ref{eq:prescibred_performance})$ με σκοπό την διευκόλυνση της ανάλυσης. Ο μετασχηματισμός αυτός έχει την μορφή:
\begin{equation}
	\varepsilon_i(t) = T_i \left( \frac{e_i(t)}{\rho_i(t)} \right)
	, \: i = 1,\dots ,p
	\label{eq:ppc_trasformation_error}
\end{equation}
όπου οι ποσότητες $\varepsilon_i(t)$ ονομάζονται μετασχηματισμένα σφάλματα, και οι συναρτήσεις μετασχηματισμού $T_i(\cdot)$ είναι θετικές, γνησίως αύξουσες που ορίζουν απεικονίσεις της μορφής:
\begin{equation*}
	T_i: \left( \barbelow{M}_i, \overline{M}_i\right) \rightarrow 
	(- \infty, \infty), \: i = 1,\dots ,p
\end{equation*}
όπου τα $\barbelow{M}_i$ και  $\overline{M}_i$ δίνονται από την εξίσωση $(\ref{eq:ppc_overshoot})$. Η ποσότητα $e_i(t)/\rho_i(t)$ ονομάζεται αλλιώς και κανονικοποιημένο σφάλμα, και συμβολίζεται ώς $\xi_i(t)$.

Μια τέτοια συνάρτηση μετασχηματισμού είναι η
\begin{equation}
	T_i \left( \frac{e_i(t)}{\rho_i(t)} \right) = T_i \left( \xi_i(t) \right) =
	\ln \left( \frac{-\barbelow{M}_i + \xi_i(t) }{\overline{M}_i - \xi_i(t)} \right)
	\label{eq:ppc_log_transform}
\end{equation}
η οποία αναπαρίσταται γραφικά και στο σχήμα $(\ref{fig:ppc_transformation_function})$. Χρησιμοποιώντας αυτό το εργαλείο, μπορούμε να επαναπροσδιορίσουμε το πρόβλημα της ΠΑΕ χρησιμοποιώντας την ακόλουθη πρόταση:

\textbf{Ισοδύναμο Πρόβλημα ΠΑΕ:}
\textit{ Εάν τα μετασχηματισμένα σφάλματα $\varepsilon_i(t), \: i = 1,\dots ,p$ της εξίσωσης $(\ref{eq:ppc_trasformation_error})$ διατηρηθούν φραγμένα, τότε ικανοποιούνται οι παρακάτω σχέσεις:
\begin{equation*}
\barbelow{M}_i \rho_i(t) < \barbelow{M}_i' \rho_i(t) \leq e_i(t) \leq \rho_i(t) \overline{M}_i' < \rho_i(t) \overline{M}_i, \quad \forall t \geq 0, \: i = 1,\dots ,p
\end{equation*}
για κάποιες σταθερές $\barbelow{M}_i'$ και $\overline{M}_i'$ για τις οποίες ισχύουν:
\begin{equation}
\barbelow{M}_i < \barbelow{M}_i' \leq \overline{M}_i' < \overline{M}_i, \: i = 1,\dots ,p
\label{eq:overshoot_bounds}
\end{equation}
}

\begin{figure}
	\centering
	\input{plots/mathematicalTools/ppc/transformation.tex}
	\caption{Συνάρτηση Μετασχηματισμού}
	\label{fig:ppc_transformation_function}
\end{figure}


%\textbf{Απόδειξη}\\
\begin{proof}
Καθώς τα $\varepsilon_i(t), \: i = 1,\dots ,p$ είναι φραγμένα, τότε θα υπάρχουν τα κάτω φράγματα $\barbelow{\varepsilon}_i$ και τα άνω φράγματα  $\overline{\varepsilon}_i$ για κάθε $i$. Αντικαθιστώντας το $\varepsilon_i(t)$ από την εξίσωση $(\ref{eq:ppc_trasformation_error})$, θα ισχύει η παρακάτω ανίσωση:
\begin{equation*}
	\barbelow{\varepsilon}_i \leq T_i \left( \frac{e_i(t)}{\rho_i(t)} \right) \leq \overline{\varepsilon}_i
	, \quad  \forall t\geq 0,  i = 1,\dots ,p
\end{equation*}

Καθώς οι συναρτήσεις μετασχηματισμού $T_i(\cdot)$ είναι ένα προς ένα και γνησίως αύξουσες, χρησιμοποιώντας τον αντίστροφο μετασχηματισμό έχουμε:
\begin{equation*}
T^{-1}( \barbelow{\varepsilon}_i ) \leq  \frac{e_i(t)}{\rho_i(t)}  \leq T^{-1}( \overline{\varepsilon}_i )
, \quad  \forall t\geq 0,  i = 1,\dots ,p
\end{equation*}
και καθώς οι συναρτήσεις επίδοσης $\rho_i(t)$ είναι θετικές, τελικά καταλήγουμε στην εξίσωση:
\begin{equation*}
T^{-1}( \barbelow{\varepsilon}_i ) \rho_i(t) \leq e_i(t) \leq T^{-1}( \overline{\varepsilon}_i ) \rho_i(t)
, \quad  \forall t\geq 0,  i = 1,\dots ,p
\end{equation*}

Ολοκληρώνουμε την απόδειξη ορίζοντας της ποσότητες:
\begin{equation*}
	\begin{matrix}
	\barbelow{M}_i' = T^{-1}( \barbelow{\varepsilon}_i ) & \: \text{και} \: & \overline{M}_i' = T^{-1}( \overline{\varepsilon}_i ), & \: i = 1,\dots ,p
	\end{matrix}
\end{equation*}
οι οποίες σημειώνουμε πως ικανοποιούν την σχέση $(\ref{eq:overshoot_bounds})$, καθώς οι ποσότητες $\barbelow{M}_i$ και $\overline{M}_i$ είναι τα όρια του αντίστροφου μετασχηματισμού $Τ^{-1}(\cdot)$ στο $-\infty$ και $+\infty$ αντίστοιχα. Αντικαθιστώντας στην παραπάνω σχέση, καταλήγουμε στο ζητούμενο:
\begin{equation*}
\barbelow{M}_i \rho_i(t) < \barbelow{M}_i' \rho_i(t) \leq e_i(t) \leq \rho_i(t) \overline{M}_i' < \rho_i(t) \overline{M}_i, \quad \forall t \geq 0, \: i = 1,\dots ,p
\end{equation*}
\end{proof}




\section{Σύστημα Αναφοράς} \label{sec:ref_system}
Τέλος, σε αυτό το κεφάλαιο θα αναφερθούμε στον μηχανισμό που παράγει τα σήματα αναφοράς τα οποία χρησιμοποιούνται στο σχήμα αναγνώρισης που αναπτύσσεται στα πλαίσια αυτής της εργασίας. Το ζητούμενο ενός τέτοιου συστήματος περιγράφεται παρακάτω.

\textbf{Περιγραφή Προβλήματος:} 
\textit{Έστω ένα δυναμικό σύστημα τάξης $n$ σε κανονική ελέγξιμη μορφή:
\begin{equation}
\begin{split}
\dot{x}_1(t) &= x_2(t) \\
\dot{x}_2(t) &= x_3(t) \\
&\vdots \\
\dot{x}_n(t) &= f(x,u,t)
\end{split}
\label{eq:canonical_system}
\end{equation}
όπου $f:\mathbb{R}^n \times \mathbb{R}\times \mathbb{R}^+ \rightarrow \mathbb{R}$ συνεχής, τοπικά Lipschitz συνεχής συνάρτηση. Να σχεδιαστεί σύστημα που θα παράγει τα σήματα αναφοράς $x_{1d}(t), x_{2d}(t), \dots, x_{nd}(t)$ για μεταβάσεις της μορφής:
\begin{equation}
	\begin{bmatrix}
		x_1(t_0) \\ x_2(t_0) \\ \vdots \\ x_n(t_0)
	\end{bmatrix}
	\rightarrow
	\begin{bmatrix}
	 x_1(t_0+ \Delta T) \\ x_2(t_0+ \Delta T) \\ \vdots \\ x_n(t_0+ \Delta T)
	\end{bmatrix}
	\label{eq:ref_transition}
\end{equation}
για κάθε αρχικό διάνυσμα $x(t_0) \in  \mathbb{R}^n$ προς κάθε τελικό διάνυσμα $x(t_0+\Delta T) \in  \mathbb{R}^n$ για ένα επιθυμητό χρονικό διάστημα μετάβασης $\Delta T$. Τέλος, θα πρέπει δυο διαδοχικές μεταβάσεις 
$x(t_0) \rightarrow x(t_0+ \Delta T) \rightarrow x(t_0+ 2\Delta T)$ να σχηματίζουν μια ομαλή καμπύλη στον χώρο $\mathbb{R}^n$.
}

Ο λόγος που διατυπώνουμε το πρόβλημα με την παραπάνω μορφή συνδέεται με την Συνθήκη Επιμένουσας Διέγερσης για RBF δίκτυα που περιγράφεται στην παράγραφο 2.2.3. Οι μεταβάσεις $x(t_0) \rightarrow x(t_0+ \Delta T)$ στην ουσία περιγράφουν την μετάβαση από ένα κέντρο $c_i$ του RBF νευρωνικού δικτύου σε ένα κέντρο $c_j$, και η διάρκεια μετάβασης $\Delta T$ συνδέεται με τον χρόνο παραμονής της επιθυμητής τροχιάς $x_d(t)$ στην γειτονία του κάθε κέντρου $c_i$.

\subsection{Μαθηματική Ανάλυση}
\subsubsection{Συνοριακές Συνθήκες}
Το πρώτο πράγμα που πρέπει να λάβει κανείς υπόψιν στην σχεδίαση είναι η μορφή της εξίσωσης $(\ref{eq:canonical_system})$. Η εξίσωση αυτή επιβάλει τον περιορισμό:
\begin{equation*}
	\dot{x}_{i}(t) = x_{i+1}(t), \quad i=1,\dots,n-1
\end{equation*}
ο οποίος προφανώς θα πρέπει να ισχύει και για τα σήματα αναφοράς $x_{di}(t)$. 

Στην συνέχεια, μελετώντας κανείς το παραπάνω πρόβλημα από την οπτική γωνία των Διαφορικών Εξισώσεων διαπιστώνει πως πρόκειται για ένα πρόβλημα συνοριακών συνθηκών, για το οποίο έχουμε $2n+2$ συνοριακές συνθήκες. Οι πρώτες $2n$ συνθήκες περιγράφονται από την εξίσωση $(\ref{eq:canonical_system})$ και είναι οι αρχικές και οι τελικές τιμές του διανύσματος καταστάσεων.

Οι άλλες $2$ προκύπτουν από την τελευταία απαίτηση η οποία αναφέρεται στην διατήρηση της ομαλότητας της καμπύλης μεταξύ δυο μεταβάσεων. Η συνθήκη αυτή εξασφαλίζεται από την συνέχεια των παραγώγων των καταστάσεων η οποία διατυπώνεται ως εξής:
\begin{equation}
	\dot{x}_{i}(t_0^-) = \dot{x}_{i}(t_0^+), \quad i=1,\dots,n
	\label{eq:deriv_continuity}
\end{equation}
Καθώς το σύστημα βρίσκεται σε κανονική μορφή, οι πρώτες $n-1$ εξισώσεις της σχέσης $(\ref{eq:deriv_continuity})$ αναφέρονται στην συνέχεια των καταστάσεων $x_2(t), \dots, x_n(t), \: i=1,\dots,n$ και συνεπώς έχουν συμπεριληφθεί ήδη στην σχεδίαση από την εξίσωση $(\ref{eq:ref_transition})$. 

Εν αντιθέσει, η συνθήκη $\dot{x}_{n}(t_0^-) = \dot{x}_{n}(t_0^+)$ δεν ικανοποιείται απαραίτητα όταν οι υπόλοιπες συνοριακές συνθήκες της σχέσης $(\ref{eq:ref_transition})$ ικανοποιούνται, και συνεπώς εισάγει δυο επιπλέον συνοριακές συνθήκες, μια για το $\dot{x}_{n}(t_0)$ και μια για το $\dot{x}_{n}(t_0+\Delta T)$.

\subsubsection{Επιλογή λύσης} \label{subseq:ref_parameterization}
Αρχικά θα θεωρήσω πως για κάθε ζητούμενη μετάβαση, η κατάσταση $x_1(t)$ περιγράφεται από το πολυώνυμο του χρόνου $t$ ως εξής:
\begin{equation}
	x_1(t) = y(t) = \sum_{j=1}^{2n + 2} \alpha_j \cdot t^{j-1},\quad \forall t \in [t_0,t_0+\Delta T]
	\label{eq:ref_de}
\end{equation}
Ο βαθμός του πολυωνύμου επιλέγεται ίσος με $2n + 1$ έτσι ώστε με κατάλληλη επιλογή των συντελεστών του πολυωνύμου $a_i$ να μπορούν να ικανοποιηθούν όλες οι συνοριακές συνθήκες. Παραγωγίζοντας την εξίσωση $(\ref{eq:ref_de})$ $n+1$ φορές, προκύπτουν οι υπόλοιπες καταστάσεις συναρτήσει του χρόνου $t$, καθώς και η παράγωγος της $n$-οστής κατάστασης για $n+1$: 
\begin{equation}
x_i(t) = \sum_{j=i}^{2n + 2} \alpha_j \cdot \prod_{k = 1}^{i-1} (j-k) 
 \cdot t^{j-i},\quad \forall t \in [t_0,t_0+\Delta T], \: i = 1,\dots, n+1
\label{eq:ref_state_polynomials}
\end{equation}

Ορίζω ως τον συντελεστή του όρου $a_j$ για την κατάσταση $x_i$ ως την συνάρτηση
\begin{equation}
	b_{i,j}(t) = \begin{cases}
	\left( \prod_{k = 1}^{i-1} (j-k) \right)
	\cdot t^{j-i} &, j \geq i \\
	0 &, j < i 
	\end{cases}
	\label{eq:ref_system_coefficients}
\end{equation}
και με αυτόν τον τρόπο μπορώ να ξαναγράψω την εξίσωση $(\ref{eq:ref_state_polynomials})$ στην γραμμική ως προς τους όρους μορφή:
\begin{equation}
x_i(t) = \sum_{j=1}^{2n + 2} b_{i,j}(t) \cdot \alpha_k 
,\quad \forall t \in [t_0,t_0+\Delta T], \: i = 1,\dots, n+1
%\label{eq:ref_state_polynomials}
\end{equation}

Χρησιμοποιώντας τον παραπάνω συμβολισμό, μπορούμε να γράψουμε τις συνοριακές συνθήκες για την χρονική στιγμή $t_0$ στην πιο συμπαγή μορφή:
\begin{equation*}
	\underbrace{
	\begin{bmatrix} x_1(t_0) \\ x_1(t_0) \\ \vdots \\ x_n(t_0) \\ \dot{x}_n(t_0)
	\end{bmatrix}}_{Y(t_0)}
	= 
	\underbrace{
	\begin{bmatrix} 
	b_{1,1}(t_0)   & b_{1,2}(t_0)   & \dots  & b_{1,2n+2}(t_0)   \\
	b_{2,1}(t_0)   & b_{2,2}(t_0)   & \dots  & b_{2,2n+2}(t_0)   \\
	\vdots       & \vdots       & \ddots & \vdots          \\
	b_{n,1}(t_0)   & b_{n,2}(t_0)   & \dots  & b_{n,2n+2}(t_0)   \\
	b_{n+1,1}(t_0) & b_{n+1,2}(t) & \dots  & b_{n+1,2n+2}(t_0) \\
	\end{bmatrix}
	}_{R(t_0)}
	\begin{bmatrix} a_1 \\ a_2 \\ \vdots \\ a_{2n+2}
	\end{bmatrix}
\end{equation*}
όπου $R(t_0)$ είναι γνωστός $n+1 \times 2(n+1)$ πίνακας και $Y(t_0)$ το $n+1 \times 1$ διάνυσμα συνοριακών συνθηκών. Γράφοντας σε αντίστοιχη μορφή τις συνοριακές συνθήκες για την χρονική στιγμή $t_0+\Delta T$, μπορούμε να εκφράσουμε το συνολικό πρόβλημα συνοριακών συνθηκών χρησιμοποιώντας τις εξισώσεις:
\begin{equation}
	\begin{bmatrix} Y(t_0) \\ Y(t_0 + \Delta T)
	\end{bmatrix} = 
	\begin{bmatrix}
	R(t_0) \\ R(t_0+\Delta T)
	\end{bmatrix}  \begin{bmatrix} a_1 \\ a_2 \\ \vdots \\ a_{2n+2}
	\end{bmatrix}
	\label{eq:ref_linear_form}
\end{equation}
Το αλγεβρικό σύστημα της εξίσωσης $(\ref{eq:ref_linear_form})$ είναι ένα σύστημα $2n+2$ εξισώσεων και $2n+2$ αγνώστων, και καθώς ο πίνακας $R$ είναι καλώς ορισμένος, το πρόβλημα έχει μια μόνο λύση η οποία υπολογίζεται ως:
\begin{equation}
	\alpha = R^{-1} Y
	\label{eq:ref_system_inv_solution}
\end{equation}

\subsection{Μορφή κλειστού βρόγχου}
Η μαθηματική ανάλυση του προηγούμενου κεφαλαίου αναφέρεται στην επιλογή και την παραμετροποίηση μιας ισοδύναμης Διαφορικής Εξίσωσης που να ικανοποιεί της ζητούμενες συνοριακές συνθήκες. Για να χρησιμοποιηθεί αυτό το αποτέλεσμα εντός ενός κλειστού βρόχου, απαιτείται να το μετασχηματίσουμε σε μορφή εξισώσεων κατάστασης. Ξεκινώντας από την λύση της διαφορικής εξίσωσης:
\begin{equation*}
	x_{1d}(t) = y(t)
\end{equation*}
πραγωγίζουμε $n$ φορές και έχουμε:
\begin{equation*}
\begin{split}
	\dot{x}_{1d}(t) &= \dot{y}(t)  \\
	\dot{x}_{2d}(t) &= \ddot{y}(t) \\
	& \vdots \\
	\dot{x}_{nd}(t) &= y^{(n)}(t)
\end{split}
\end{equation*}
Με βάση τα παραπάνω, χρησιμοποιώντας την σχέση $y^{(i)}(t) = x_{(i+1)d}(t)$ και ορίζοντας την παράγωγο $n$-οστή παράγωγο $y^{(n)}(t)$ ως $\nu(t)$ τελικά καταλήγουμε στις εξισώσεις κατάστασης του συστήματος αναφοράς:
\begin{equation}
\Sigma_{ref}
\begin{cases}
\dot{x}_{1d}(t) &= x_{2d}(t)  \\
\dot{x}_{2d}(t) &= x_{3d}(t) \\
& \vdots \\
\dot{x}_{nd}(t) &= \nu(t)
\end{cases}
\label{eq:ref_system}
\end{equation}
Η είσοδος ελέγχου του συστήματος αναφοράς ορίζεται με την βοήθεια της σχέσης $(\ref{eq:ref_system_coefficients})$ ως:
\begin{equation*}
	\nu(t) = y^{(n)}(t) = \sum_{j=1}^{2n + 2} b_{n+1,j}(t) \cdot \alpha_j 
	,\quad \forall t \in [t_0,t_0+\Delta T]
\end{equation*}
όπου τα βάρη $a_j$ υπολογίζονται για κάθε μετάβαση με την βοήθεια της σχέσης $(\ref{eq:ref_linear_form})$.

\begin{figure}
	\begin{subfigure}{0.5\textwidth}
		\includegraphics[scale=1]{plots/mathematicalTools/ref/2d_ref.tex}
		\caption{Δευτεροβάθμιο Σύστημα}
	\end{subfigure}
	\begin{subfigure}{0.5\textwidth}
		\includegraphics[scale=1]{plots/mathematicalTools/ref/3d_ref.tex}
		\caption{Τριτοβάθμιο Συστημα}
	\end{subfigure}
	\caption{ Τροχιές αναφοράς που διέρχονται από τα επιθυμητά κέντρα $c$ }
	\label{fig:ref_trajectories}
\end{figure}

\subsection{Παραδείγματα χρήσης}
Τέλος για να δείξουμε πως το προτεινόμενο σύστημα αναφοράς ικανοποιεί τις απαιτήσεις, παραθέτουμε δυο παραδείγματα στα οποία σκοπός είναι ο σχηματισμός μιας κλειστής ομαλής τροχιάς που να διέρχεται από κάποια επιθυμητά σημεία του χώρου $\mathbb{R}^2$ και $\mathbb{R}^3$ αντίστοιχα.

Το παραπάνω σενάριο είναι ακριβώς ο τρόπος με τον οποίο εφαρμόζεται η θεωρία που αναπτύξαμε σε αυτή την παράγραφο και στο πραγματικό πρόβλημα, όπου το ζητούμενο είναι να σχεδιαστεί μια περιοδική τροχιά αναφοράς που να διέρχεται από όλα τα κέντρα ενός πλέγματος από γκαουσιανές συναρτήσεις βάσης, όπως επιτάσσει η ΣΕΔ για νευρωνικά δίκτυα RBF.

Στο σχήμα $(\ref{fig:ref_trajectories})$ φαίνεται πως πράγματι, και στις δυο περιπτώσεις, το προσομοιωμένο σύστημα αναφοράς της εξίσωσης $(\ref{eq:ref_system})$ παράγει μια κλειστή και ομαλή τροχιά που να διέρχεται από όλα τα επιθυμητά σημεία.



\section{Δυναμικά Συστήματα} \label{sec:dynamical_systems}
Τέλος, σε αυτό το Κεφάλαιο παραθέτουμε κάποια χρήσιμα αποτελέσματα από την θεωρία δυναμικών συστημάτων τα οποία χρησιμοποιούνται κατά την μαθηματική απόδειξη της ορθότητας του προτεινόμενου σχήματος αναγνώρισης.

Έστω το πρόβλημα αρχικών τιμών:
\begin{equation}
	\dot{\psi} = H(t, \psi), \quad \psi(0) = \psi_0 \in \Omega_\psi
	\label{eq:ivp_sontag}
\end{equation}
όπου $H: \mathbb{R}^+ \times \Omega_\psi \rightarrow \mathbb{R}^n $ ένα συνεχές διανυσματικό πεδίο και $\Omega_\psi \subset \mathbb{R}^n$ ένα μη κενό και ανοιχτό σύνολο.\\

\begin{definition}\cite{sontag1998}~
	Μια λύση $\psi(t)$ για $t \in [0, \tau_f)$ του προβλήματος αρχικών τιμών της εξίσωσης~\eqref{eq:ivp_sontag} θα ονομάζεται \textit{μέγιστα επεκτεταμένη (maximal solution)}, αν δεν υπάρχει κανονική επέκταση της για $t \geq \tau_f$
	που να αποτελεί επίσης λύση του ίδιου προβλήματος αρχικών τιμών.\\
\end{definition}

\begin{theorem}\cite{sontag1998}~
	\textit{Έστω το πρόβλημα αρχικών τιμών της εξίσωσης~\eqref{eq:ivp_sontag} με το διανυσματικό πεδίο $H(t, \psi)$ να είναι:}
	\begin{enumerate}
		\item \textit{τοπικά Lipschitz συνεχές ως προς το όρισμα $\psi$ για κάθε $t \geq 0$}
		
		\item τ\textit{μηματικά συνεχής ως προς τον χρόνο $t$ για κάθε σταθερό $\psi \in \Omega_\psi$}
		
		\item \textit{τοπικά ολοκληρώσιμο ως προς τον χρόνο $t$ για κάθε σταθερό $\psi \in \Omega_\psi$}
	\end{enumerate}
	\textit{Τότε θα υπάρχει μια μοναδική μέγιστα επεκτεταμένη λύση $\psi(t)$ για το πρόβλημα αρχικών τιμών, έτσι ώστε $\psi(t) \in \Omega_\psi$ για κάθε $t \in [0, \tau_f)$ με $\tau_f >0$.}\\
	\label{thrm:maximal_existance} 
\end{theorem}

\begin{proposition}\cite{sontag1998}~
	Έστω ότι οι προϋποθέσεις του Θεωρήματος \ref{thrm:maximal_existance} ισχύουν. Θεωρήστε την μέγιστα επεκτεταμένη λύση $\psi(t)$ στο χρονικό διάστημα $[0,\tau_f)$ όπου $\tau_f < \infty$. Τότε, για οποιοδήποτε συμπαγές σύνολο $\Omega'_\psi $ το οποίο είναι υποσύνολο του $\Omega_\psi$ θα υπάρχει μια χρονική στιγμή $t' \in [0,\tau_f)$ έτσι ώστε $\psi(t') \notin \Omega'_\psi $.
	\label{prop:maximal_subset}
\end{proposition}

