\chapter{Σχήμα Αναγνώρισης}
Σε αυτό το κεφάλαιο παρουσιάζεται ένα σχήμα αναγνώρισης για μη-γραμμικά συστήματα ΠΕΠΕ (πολλαπλών εισόδων, πολλαπλών εξόδων) σε κανονική μορφή, βασισμένο στα νευρωνικά δίκτυα RBF καθώς και στον έλεγχο προδιαγεγραμμένης απόκρισης.


\section{Ορισμός του Προβλήματος}
Σκοπός αυτής της παραγράφου είναι η παρουσίαση του προβλήματος που ασχολείται η παρούσα εργασία. Για τον σκοπό αυτό, ακολουθεί μια μαθηματική περιγραφή της κλάσης των συστημάτων που μελετάμε, η παρουσίαση των βασικών υποθέσεων που γίνονται για τα συστήματα αυτά και τέλος η επίσημη διατύπωση του προβλήματος.
\subsection{Δομή του συστήματος}
Έστω ένα μη-γραμμικό συνεχές χρονοαμετάβλητο σύστημα ΠΕΠΕ $m$ εισόδων και $m$ εξόδων σε κανονική μορφή το οποίο περιγράφεται από τις εξισώσεις:
\begin{equation}
\begin{alignedat}{3}
x_1^{(n_1)} &= f_1(x)   &+g_{11}(x) u_1 + \dots & + g_{1m}(x)u_m \\
            &\vdots & & \\
x_m^{(n_m)} &= f_m(x)  &+g_{m1}(x) u_1 + \dots & + g_{mm}(x)u_m
\end{alignedat}
\label{eq:mimo_nonlinear}
\end{equation}
με 
\begin{equation*}
\begin{split}
x_i^{(n_i)}    &:= \frac{d^{n_i} x_i }{d t^{n_i}} \\
x   &:= \begin{bmatrix} x_1 &\cdots & x_1^{(n_1-1)} & \cdots &
                               x_m &\cdots & x_m^{(n_m-1)}\end{bmatrix}^T \in \mathbb{R}^n \\
        n  &= n_1 + \cdots  + n_m \\
        y  &= \begin{bmatrix}
        x_1(t) & \dots & x_m(t)
        \end{bmatrix}^T \in \mathbb{R}^m
\end{split}
\end{equation*}
όπου $x \in \mathbb{R}^n$ είναι το διάνυσμα καταστάσεων, $n$ η συνολική τάξη του συστήματος, $m$ ο αριθμός υποσυστημάτων και $u \in \mathbb{R}^m$ το διάνυσμα των εισόδων ελέγχου, και $y \in \mathbb{R}^m $ το διάνυσμα εξόδων. Το σύστημα της εξίσωσης $(\ref{eq:mimo_nonlinear})$ μπορεί να γραφτεί και στην πιο συμπαγή μορφή:
\begin{equation}
	x^{(n)} = F(x) + G(x)u
	\label{eq:mimo_compact}
\end{equation}
ορίζοντας το διάνυσμα $F(x)$ και τον πίνακα $G(x)$ ως:
\begin{equation}
	\begin{matrix}
	F(x) = \begin{bmatrix} f_1(x) \\ \vdots \\ f_m(x) \end{bmatrix}
	& \: \text{και} \: &
	G(x) = \begin{bmatrix} g_{11}(x) & \cdots & g_{1m}(x) \\
						   \vdots    & \ddots & \vdots    \\
						   g_{m1}(x) & \cdots & g_{mm}(x)
	\end{bmatrix}
	\end{matrix}
	\label{eq:mimo_vec_functions}
\end{equation}
και το διάνυσμα $x^{(n)}$ ως:
\begin{equation*}
	x^{(n)} = \begin{bmatrix} x_1^{(n_1)} & \cdots & x_m^{(n_m)} \end{bmatrix}^T
	\in \mathbb{R}^m
\end{equation*}

\subsection{Υποθέσεις} \label{assumptions}
Σε αυτό το σημείο περιγράφονται κάποιες υποθέσεις που θα θεωρήσουμε ότι πληρούνται από το σύστημα που εξετάζεται. Οι υποθέσεις αυτές είναι θεμελιώδους σημασίας για την μαθηματική ανάλυση που ακολουθεί, και για συστήματα στα οποία δεν ισχύουν, ενδέχεται η εφαρμογή της μεθόδου που περιγράφει το κεφάλαιο να μην επιφέρει τα αποτελέσματα που εξασφαλίζει η μαθηματική ανάλυση.

\textbf{Υπόθεση 1:} Ο πίνακας $G(x)$ είναι θετικά ορισμένος εντός ενός συνόλου $A \supset \Omega$, δηλαδή η μικρότερη ιδιοτιμή του συμμετρικού του πίνακα είναι μεγαλύτερη από μια θετική σταθερά $\lambda^*$ όπως περιγράφει η παρακάτω εξίσωση.
\begin{equation}
	\lambda_{min} \left(\frac{G(x) + G^T (x)}{2}\right) \geq \lambda^* > 0
	,\quad \forall x \in A
	\label{eq:assump_1}
\end{equation}

\textbf{Υπόθεση 2:} Το εξεταζόμενο σύστημα είναι σύστημα Euler–Lagrange, δηλαδή ο πίνακας $G(x)$ δεν είναι συνάρτηση του διανύσματος $x^{(n)}$, η μαθηματικά:
\begin{equation}
	\frac{\partial G(x)}{\partial x^{(n_i-1)}} = 0, \quad \forall x \in \mathbb{R}^n, i = 1,\dots,m
	\label{eq:assump_2}
\end{equation}

\textbf{Υπόθεση 3:} Το πλήρες διάνυσμα καταστάσεων $x \in \mathbb{R}^n$ είναι διαθέσιμο προς μέτρηση σε κάθε χρονική στιγμή $t$.

\subsection{Διατύπωση του προβλήματος αναγνώρισης} \label{subsec:problem_definition}
Τέλος, έχοντας ορίσει τόσο την δομή των συστημάτων με τα οποία ασχολείται η εργασία, όσο τις υποθέσεις που πρέπει αυτά τα συστήματα να ικανοποιούν, είμαστε σε θέση να διατυπώσουμε το πρόβλημα με το οποίο ασχολείται η παρούσα εργασία.

\textbf{Πρόβλημα (Αναγνώριση μη-γραμμικού ΠΕΠΕ):}\\
Έστω ένα σύστημα ΠΕΠΕ της εξίσωσης $(\ref{eq:canonical_system})$ το οποίο ικανοποιεί της υποθέσεις της παραγράφου $\ref{assumptions}$. Για το σύστημα αυτό να σχεδιαστεί σχήμα αναγνώρισης κλειστού βρόγχου, ικανό να προσεγγίσει αρκούντως καλά την άγνωστη δυναμική του που περιγράφεται από το διάνυσμα $F(x)$ και τον πίνακα $G(x)$ της εξίσωσης $(\ref{eq:mimo_vec_functions})$ εντός ενός κλειστού και συμπαγούς συνόλου $\Omega$, και ταυτόχρονα να διασφαλίζει πως όλα τα σήματα κλειστού βρόγχου θα παραμένουν φραγμένα για κάθε $t \geq 0$.

\section{Υποσυστήματα}
Με βάση τα παραπάνω, σε αυτή την παράγραφο αναλύεται ο τρόπος με τον οποίο θα χρησιμοποιηθούν τα μαθηματικά εργαλεία του κεφαλαίου $\ref{chap:mathematical_tools}$ προς την επίλυση του προβλήματος, όπως αυτό ορίζεται την παράγραφο $\ref{subsec:problem_definition}$.

\subsection{Προσέγγιση με Νευρωνικά Δίκτυα}
Καθώς το ζητούμενο είναι η αναγνώριση της άγνωστης δυναμικής του συστήματος, η οποία περιγράφεται από τις άγνωστες συναρτήσεις $F(x)$ και $G(x)$ εντός ενός συνόλου $\Omega$, θα χρησιμοποιηθούν τα νευρωνικά δίκτυα RBF, τα οποία όπως έχουμε δείξει στο κεφάλαιο $\ref{chap:mathematical_tools}$, έχουν την δυνατότητα να προσεγγίσουν οποιαδήποτε μη-γραμμική συνάρτηση.

Για λόγους που δεν είναι εμφανής ακόμα, αλλά θα αποσαφηνισθούν κατά την μαθηματική ανάλυση, μέσω των δικτύων RBF θα προσπαθήσουμε να προσεγγίσουμε τις συναρτήσεις:
\begin{equation}
	\begin{matrix}
	\varPhi(x) \coloneqq F(x)G^{-1}(x) & \: \text{και} &
	\Gamma(x) \coloneqq G^{-1}(x)
	\end{matrix}
	\label{eq:approximate_functions}
\end{equation}

Καθώς το διάνυσμα $F(x)$ είναι συνάρτηση του πλήρους διανύσματος καταστάσεων $x \in \mathbb{R}^n$, ενώ ο πίνακας $G(x)$ είναι συνάρτηση μόνο των πρώτων $n_i - 1$ καταστάσεων κάθε υποσυστήματος $i$, θα χρησιμοποιηθεί διαφορετικό set οπισθοδρομητών για τις δυο αυτές περιπτώσεις, καθώς στην αντίθετη περίπτωση εισάγεται περιττή πολυπλοκότητα στην προσέγγιση της $\Gamma(x)$. Συνεπώς, συμβολίζουμε με $Z_{\varPhi}(x)$ το διάνυσμα οπισθοδρομητών για την προσέγγιση του διανύσματος $\varPhi(x)$ και με $Z_{\Gamma}(x)$ το διάνυσμα οπισθοδρομητών της $\Gamma(x)$.

Χρησιμοποιώντας την ιδιότητα προσέγγισης της παραγράφου $\ref{subsec:rbf_approximation_theorem}$, χωρίς βλάβη γενικότητας αντικαθιστούμε κάθε  συνάρτηση $\varphi_i(x)$ και $\gamma_{ij}(x)$ των $\varPhi(x)$ και $\Gamma(x)$ με τις προσεγγίσεις τους:
\begin{equation}
\begin{alignedat}{2}
	\varphi_i(x) &= w_{\varphi_i}^{*T} Z_{\varPhi}(x) + \epsilon_{\varphi_i}(x), \quad &\forall x \in \Omega \\
	\gamma_{ij}(x) &= w_{\gamma_{ij}}^{*T} Z_{\Gamma}(x) + \epsilon_{\gamma_{ij}}(x), \quad &\forall x \in \Omega
\end{alignedat}
\label{eq:rbf_approximations}
\end{equation}
όπου $q_{\varPhi}$ και $q_{\Gamma}$ το μέγεθος του κάθε νευρωνικού δικτύου, $w_{\varphi_i}^{*} \in \mathbb{R}^{q_{\varPhi}}$ και $w_{\gamma_{ij}}^{*} \in \mathbb{R}^{q_{\Gamma}}$ τα βέλτιστα βάρη των νευρωνικών δικτύων της αντίστοιχης συνάρτησης, και $\epsilon_{\varphi_i}(x)$ και $\epsilon_{\gamma_{ij}}(x)$ τα σφάλματα μοντελοποίησης, τα οποία έχουν ένα άγνωστο άνω φράγμα που περιγράφεται από τις εξισώσεις:
\begin{equation}
\begin{alignedat}{3}
	| \epsilon_{\varphi_i}(x) | &\leq \bar{\epsilon}_{\varphi_i}, \quad &&\forall x \in \Omega, \quad  i&&= 1,\dots,m \\
	| \epsilon_{\gamma_{ij}}(x) | &\leq \bar{\epsilon}_{\gamma_{ij}}, \quad &&\forall x \in \Omega, \quad i,j &&= 1,\dots,m \\
	\end{alignedat}
\end{equation}

Με βάση την εξίσωση $(\ref{eq:rbf_approximations})$, γράφουμε τα $\varPhi(x)$ και $\Gamma(x)$ στην διανυσματική τους μορφή:
\begin{equation}
\begin{split}
	\varPhi(x) &= W_{\varPhi}^{*T}(x)Z_{\varPhi}(x) + \epsilon_{\varPhi}(x) \\ 
	\Gamma(x) &= W_{\Gamma}^{*T}(x)Z_{\Gamma}(x) + \epsilon_{\Gamma}(x) \\
\end{split}	
\end{equation}
η οποία θα χρησιμοποιηθεί στην ανάλυση (μπορεί να αλλάξει άμα δεν βολεύει).

Τέλος, ορίζουμε τις προσεγγίσεις των συναρτήσεων $\varPhi(x)$ και $\Gamma(x)$ ως:
\begin{equation}
\begin{split}
\hat{\varPhi}(x) &= \hat{W}_{\varPhi}^{T}(x)Z_{\varPhi}(x) \\ 
\hat{\Gamma}(x) &= \hat{W}_{\Gamma}^{T}(x)Z_{\Gamma}(x)    \\
\end{split}
\label{eq:online_approximations}
\end{equation}
(ομοίως μπορεί να αλλάξει)

\subsubsection{Συνθήκη Επιμένουσας Διέγερσης}
Με βάση τα συμπεράσματα της υποπαραγράφου \ref{subsec:rbf_PE}, για να επιτευχθεί σύγκλιση των βαρών $\hat{W}_{\varPhi}^{T}(x)$ και $\hat{W}_{\Gamma}^{T}(x)$ στα βέλτιστα βάση $W_{\varPhi}^{*T}$ και $W_{\Gamma}^{*T}$, απαιτείται ο σχεδιασμός και η παρακολούθηση μιας περιοδικής τροχιάς αναφοράς $x_d(t)$ η οποία θα διέρχεται από όλα τα κέντρα $c$ των νευρωνικών δικτύων RBF.

\subsection{Σύστημα Αναφοράς και ορισμός σφαλμάτων}
Στην προσπάθεια αναγνώρισης της άγνωστης δυναμικής του συστήματος $(\ref{eq:canonical_system})$, απαιτείται ένα σύστημα αναφοράς το οποίο θα παράγει την επιθυμητή τροχιά $x_d(t)$. Στην παράγραφο $\ref{sec:ref_system}$ αναπτύχθηκε ένα τέτοιο σύστημα, για συστήματα μιας εισόδου μιας εξόδου. Σε αυτό το σημείο θα δείξουμε πως αυτό χρησιμοποιείται για την επίλυση του προβλήματος της παραγράφου $\ref{subsec:problem_definition}$.

Για κάθε υποσύστημα $i$ του συστήματος $\ref{eq:mimo_nonlinear}$, ορίζω ένα σύστημα αναφοράς $\Sigma_i$, το οποίο υλοποιεί την τροχιά αναφοράς $x_{id}(t)$, καθώς και τις παραγώγους της μέχρι τάξης $n_i$: $x_{id}^{(j)},\: j = 1,\dots,n_i$. Τέλος, η $n_i$-οστή παράγωγος του συστήματος αναφοράς, δίνεται από τον τύπο:
\begin{equation}
	x_{id}^{(n_i)}(t) = \nu_i(t), \quad \forall i = 1,\dots,m
\end{equation}
όπου $\nu_i(t)$ είναι η είσοδος αναφοράς του $i$-οστού υποσυστήματος. Η είσοδος αυτή υπολογίζεται σύμφωνα με τον τύπο:
\begin{equation}
	\nu_i(t) = \sum_{k=n_i + 1}^{2(n_i + 1)} \prod_{l = 1}^{n_i} (k-l) \alpha_k t^{k - n_i - 1}
	,\quad \forall t \in [t_0,t_0+\Delta T]
\end{equation}
Στο σημείο αυτό δεν χρειάζεται να ορίσουμε τον τρόπο με τον οποίο επιλέγονται οι παράμετροι $\alpha_k$, αλλά θα γίνει εμφανές στην συνέχεια της ανάλυσης.

%όπου τα βάρη $a$ κάθε υποσυστήματος υπολογίζονται ανάλογα με την επιθυμητή μετάβαση, όπως περιγράφεται στην παράγραφο $(\ref{subseq:ref_parameterization})$.

\textbf{Σημείωση:} Κάθε σύστημα αναφοράς $\Sigma_i$ που περιγράψαμε στην προηγούμενη παράγραφο, έχει στην ουσία την μορφή της εξίσωσης $(\ref{eq:ref_system})$, δηλαδή:
\begin{equation*}
\Sigma_i
\begin{cases}
\dot{x}_{1d}(t) &= x_{2d}(t)  \\
\dot{x}_{2d}(t) &= x_{3d}(t) \\
                & \vdots \\
\dot{x}_{n_i d}(t) &= \nu_i(t)
\end{cases}
\label{eq:ref_subsystem}
\end{equation*}
απλά χρησιμοποιούμε διαφορετικό συμβολισμό για να διατηρήσουμε την συμβατότητα με την σχέση $(\ref{eq:canonical_system})$.

Χρησιμοποιώντας $m$ τέτοια υποσυστήματα, παράγουμε την συνολική τροχιά αναφοράς του συστήματος:
\begin{equation}
	x_d(t) = \begin{bmatrix}
	x_{1d}(t) & \dots & x_{1d}^{(n_1-1)} & \dots & 
	x_{md}(t) & \dots & x_{md}^{(n_m-1)}
	\end{bmatrix} \in \mathbb{R}^n
	\label{eq:x_desired}
\end{equation}

\subsection{Έλεγχος του συστήματος} % Η ίσως Ελεγχος και ΣΚΒ.
Για την λύση του προβλήματος παρακολούθησης της τροχιάς $x_d(t)$ θα χρησιμοποιηθεί ο Έλεγχος Προδιαγεγραμμένης Απόκρισης. Σε αυτό το κεφάλαιο ορίζονται τα σήματα κλειστού βρόγχου που θα χρησιμοποιηθούν στην ανάλυση, καθώς και διατυπώνεται επίσημα ο στόχος ελέγχου. Η απόδειξη πως η προτεινόμενη μεθοδολογία επιτυγχάνει τον στόχο ελέγχου γίνεται στο υποκεφάλαιο (τοδο).

Αρχικά ορίζουμε το σφάλμα παρακολούθησης εξόδου ως:
\begin{equation*}
	e_i(t) = x_i(t) - x_{di}(t), \quad i=1,\dots,m
\end{equation*}
και τα σφάλματα καταστάσεων κάθε υποσυστήματος ως:
\begin{equation*}
	e_i^{(j)}(t) = x_i^{(j)}(t) - x_{id}^{(j)}(t), 
	\quad j = 0,\dots, n_i - 1
\end{equation*}

Στην συνέχεια, για το κάθε υποσύστημα, ορίζουμε ένα φίλτρο $s_i$ ως εξής:
\begin{equation}
\begin{alignedat}{2}
	s_i(t) &= \left( 
	\frac{d}{dt} + \lambda
	\right)^{(n_i - 1)} e_i(t), \quad &&i=1,\dots,m \\
	%%%
	&=\sum_{j=0}^{n_i-1}\binom{n_i-1}{j} \lambda^j e_i^{(n_i-j)}(t), \quad &&i=1,\dots,m \\
\end{alignedat}
\end{equation}
όπου $\lambda$ θετικό κέρδος. Παραγωγίζοντας ως προς τον χρόνο κάθε όρο $s_i(t)$ έχουμε:
\begin{equation}
	\dot{s}_i(t) = x_i^{(n_i)} - 
	\underbrace{x_{id}^{(n_i)} + \sum_{j=1}^{n_i-1}\binom{n_i-1}{j}
	\lambda^j e_i^{(n_i-j+1)}(t)}_{d_i(t)},
	\quad i=1,\dots,m
	\label{eq:s_der}
\end{equation}
Ο όρος $d_i(t)$ της εξίσωσης $(\ref{eq:s_der})$ είναι γνωστός για κάθε υποσύστημα $i$ αφού όλες οι καταστάσεις $x_{id}^{(j)}$ και $x_{i}^{(j)}$ είναι μετρήσιμα σήματα, και επιπλέον οι όροι $x_{id}^{(n_i)}$ είναι στην ουσία οι είσοδοι $\nu_i(t)$ των συστημάτων αναφοράς. Συνεπώς, τα σήματα $d_i(t)$ μπορούν να χρησιμοποιηθούν στον σχεδιασμό της εισόδου ελέγχου $u(t)$.

Τέλος, ορίζουμε το διάνυσμα φιλτραρισμένων σφαλμάτων ως:
\begin{equation*}
	s(t) = \begin{bmatrix}s_1(t) & \dots & s_m(t)\end{bmatrix}^T 
	\in \mathbb{R}^m
\end{equation*}
και την παράγωγο του ως:
\begin{equation}
	\dot{s}(t) = x^{(n)}(t) + d(t) \in \mathbb{R}^m
	\label{eq:filter_ders_vec}
\end{equation}
, όπου το διάνυσμα $d(t)$ ορίζεται ως
\begin{equation*}
d(t) = \begin{bmatrix}d_1(t) & \dots & d_m(t)\end{bmatrix}^T 
\in \mathbb{R}^m
\end{equation*}
και θεωρείται γνωστό.


\textbf{Υποπρόβλημα(Έλεγχος Προδιαγεγραμμένης Απόκρισης):} 
\emph{Να σχεδιαστεί μια είσοδος ελέγχου $u(t) \in \mathbb{R}^m$ η οποία να εγγυάται την σύγκλιση των σφαλμάτων $s_i(t)$ σε μια ζώνη,τα χαρακτηριστικά της οποίας καθορίζονται από μια επιθυμητή συνάρτηση επίδοσης $\rho(t)$.
\begin{equation}
	|s_i(t)| < \rho(t), \quad \forall t \geq 0, \: i=1,\dots,m
	\label{eq:control_objective}
\end{equation}
}

Ορίζοντας το προβλήματος ελέγχου με τον παραπάνω τρόπο, επιτυγχάνεται σημαντική απλοποίηση του σχήματος ελέγχου σε σύγκριση με τον κλασσικό έλεγχο προδιαγεγραμμένης απόκρισης της εργασίας~\cite{bechlioulis2008robust}. Ταυτόχρονα, λύνεται το πρόβλημα παρακολούθησης της τροχιάς $x_d(t)$ στην μόνιμη κατάσταση, αφού με βάση την ανάλυση του βιβλίου~\cite[p.276-280]{slotine1991applied}, ικανοποίηση της εξίσωσης $(\ref{eq:control_objective})$ συνεπάγεται σε σύγκλιση των σφαλμάτων $e_i^{(j)}(t),\: i = 1,\dots,m, \: j = 1,\dots,n_i-1$ στα σύνολα:
\begin{equation}
	E_{i,j} = \left\{ e_i^{(j)} \in \mathbb{R} :
			\frac{ 2^{j-1} \lim\limits_{t \rightarrow \infty}\rho(t)}{\lambda^{n_i - j}} \right\}
\end{equation}

Σε αυτό το σημείο σημειώνεται πως χρησιμοποιείται μια καθολική συνάρτηση επίδοσης $\rho(t)$ για όλα τα υποσυστήματα, καθώς μια αρκεί για να καλύψει τις απαιτήσεις της εφαρμογής. Έτσι, αποφεύγεται η εισαγωγή περιττής πολυπλοκότητας τόσο στον τελικό ελεγκτή όσο και στην ανάλυση που θα ακολουθήσει.

Τέλος, ορίζουμε τα κανονικοποιημένα ως προς την συνάρτηση επίδοσης σφάλματα $\xi_i(t)$:
\begin{equation}
	\xi_i(t) = \frac{s_i(t)}{\rho(t)}, \quad i=1,\dots,m
	\label{eq:xi_i}
\end{equation}
καθώς και τις παραγώγους αυτών:
\begin{equation}
	\dot{\xi}_i(t) =
	\frac{\dot{s}_i(t) \rho(t) - s(t) \dot{\rho}(t)}
	{\rho^2(t)} \stackrel{(\ref{eq:xi_i})}{=}
	\frac{\dot{s}_i(t) - \xi_i(t) \dot{\rho}(t)}{\rho(t)},
	\quad i=1,\dots,m
	\label{eq:xi_i_dot}
\end{equation}
Γράφοντας την εξίσωση $(\ref{eq:xi_i})$ ως διάνυσμα, προκύπτει:
\begin{equation}
	\xi(t) = \frac{s(t)}{\rho(t)} = \begin{bmatrix}\xi_1(t) & \dots & \xi_m(t)\end{bmatrix}^T 
	\in \mathbb{R}^m
\end{equation}
και με την βοήθεια των εξισώσεων $(\ref{eq:mimo_compact})$ και  $(\ref{eq:filter_ders_vec})$ έχουμε την διανυσματική μορφή της παραγώγου $\dot{\xi}(t)$ ως:
\begin{equation}
\begin{split}
\dot{\xi}(t) &= \frac{\dot{s}(t) - \xi(t) \dot{\rho}(t)}{\rho(t)} \\
             &= \frac{x^{(n)}(t) + d(t) - \xi(t) \dot{\rho}(t)}{\rho(t)}\\
             &=\frac{F(x) + G(x)u(t) + d(t) - \xi(t)\dot{\rho}(t)}{\rho(t)}
\end{split}
\label{eq:xi_dot}
\end{equation}
η οποία αποτελεί σημείο έναρξης για την μαθηματική ανάλυση που θα ακολουθήσει.

Όπως περιγράφεται στην παράγραφο $\ref{sec:ppc}$, σημείο κλειδί για την επιτυχία του Ελέγχου Προδιαγεγραμμένης απόκρισης είναι οι συναρτήσεις μετασχηματισμού $T$. Έτσι λοιπόν, εδώ ορίζουμε τις συναρτήσεις μετασχηματισμού ως:
\begin{equation}
	T(\xi_i) = \ln \left( \frac{1 + \xi_i(t)}{1 - \xi_i(t)} \right),
	\quad i=1,\dots,m
\end{equation}
Και εδώ σημειώνεται πως θα μπορούσαμε να ορίσουμε προδιαγραφές για την υπερύψωση κάθε υποσυστήματος εισάγοντας μια διαφορετική συνάρτηση μετασχηματισμού $T_i(\cdot)$ για κάθε υποσύστημα. Παρόλα αυτά, κάτι τέτοιο δεν είναι αναγκαίο για τις ανάγκες της παρούσας εφαρμογής αναγνώρισης οπότε επιλέγεται μια συνάρτηση μετασχηματισμού $T(\cdot)$ για όλα τα υποσυστήματα, με σκοπό την απλοποίηση του σχήματος ελέγχου.

Τέλος, το διάνυσμα $T(\xi)$ ορίζεται ώς :
\begin{equation*}
	T(\xi(t)) = \begin{bmatrix}
	\ln \left( \frac{1 + \xi_1(t)}{1 - \xi_1(t)} \right) \\
	\vdots \\
	\ln \left( \frac{1 + \xi_m(t)}{1 - \xi_m(t)} \right)
	\end{bmatrix}
	\in \mathbb{R}^m
\end{equation*}


\section{Μαθηματική Ανάλυση}
Έστω το σύστημα της εξίσωσης $(\ref{eq:mimo_nonlinear})$ υπό τις υποθέσεις της παραγράφου $\ref{assumptions}$, και οι προσεγγίσεις των αγνώστων συναρτήσεων του συστήματος των εξισώσεων $todo$.

Η είσοδος ελέγχου του συστήματος $u(t) \in \mathbb{R}^m$ επιλέγεται ως:
\begin{equation}
	u(t) = -k T(\xi(t)) - \hat{\Phi}(x,t) 
	     - \hat{\Gamma}(x,t) \left( d(t) - \xi(t) \dot{\rho}(t) \right)
	     \in \mathbb{R}^m
	\label{eq:schema_control_input}
\end{equation}
και οι νόμοι προσαρμογής των βαρών την προσεγγίσεων $\hat{\varphi}_i(x)$ και $\hat{\gamma}_{ij}(x)$ ως:
\begin{equation}
\begin{alignedat}{3}
	\dot{\hat{w}}_{\varphi_i}(t) &= 
	\beta_{\varphi_i} \frac{\xi_i(t)}{\rho(t)} Z_{\Phi}(x) 
	\in \mathbb{R}^{q_{\Phi}}, \quad &&i &&= 1,\dots,m \\
	%%%%%
	\dot{\hat{w}}_{\gamma_{ij}}(t) &= \beta_{\gamma_{ij}} \frac{\xi_i(t)}{\rho(t)}
	\big( d_j(t) - \xi_j(t) \dot{\rho}(t) \big) Z_{\Gamma}(x)
	\in \mathbb{R}^{q_{\Gamma}},
	\quad i,&&j &&= 1,\dots,m
\end{alignedat}
\label{eq:schema_adapt_laws}
\end{equation}
όπου $k$ θετικό κέρδος ελέγχου, και $\beta_{\varphi_i}$ και $\beta_{\gamma_{ij}}$ τα κέρδη αναγνώρισης του σχήματος.

\textbf{Θεώρημα:}\\
Έστω ένα σύστημα ΠΕΠΕ που περιγράφεται από τις εξισώσεις $(\ref{eq:mimo_nonlinear})$ και ικανοποιεί τις υποθέσεις της παραγράφου $\ref{assumptions}$. Για αυτό το σύστημα, η είσοδος ελέγχου της εξίσωσης $(\ref{eq:schema_control_input})$ και οι νόμοι προσαρμογής της εξίσωσης $(\ref{eq:schema_adapt_laws})$ εγγυώνται πως 1) όλα τα σήματα κλειστού βρόγχου θα παραμένουν φραγμένα $\forall t\geq 0$ και 2) τα σφάλματα καταστάσεων $e_i^{(j)}(t)$ για $i=1,\dots,m$ και $j = 1,\dots,n_i$ θα συγκλίνουν στα σύνολα:
\begin{equation}
E_{i,j} = \left\{ e_i^{(j)} \in \mathbb{R} :
\frac{ 2^{j-1} \lim\limits_{t \rightarrow \infty}\rho(t)}{\lambda^{n_i - j}} \right\}
\end{equation}

\begin{proof}
Έστω η υποψήφια συνάρτηση Lyapunov:
\begin{equation}
	\begin{split}
	V(x,t) = \frac{\xi^T(t) G^{-1}(x) \xi(t)}{2} 
		   % phi
		   &+ \frac{1}{2} \sum_{i=1}^{m} \beta_{\varphi_i} 
		   \tilde{w}_{\varphi_i}^{T} \tilde{w}_{\varphi_i} \\
		   % gamma
		   &+ \frac{1}{2} \sum_{i=1}^{m} \sum_{j=1}^{m} \beta_{\gamma_{ij}}
		   \tilde{w}_{\varphi_{\gamma_{ij}}}^{T} \tilde{w}_{\varphi_{\gamma_{ij}}}
	\end{split}
	\label{eq:scheme_lyap}
\end{equation}
η οποία είναι θετικά ορισμένη αφού ο πίνακας $G(x)$ είναι θετικά ορισμένος, και κατά συνέπεια και ο αντίστροφος πίνακας $G^{-1}(x)$ είναι επίσης θετικά ορισμένος.

Παραγωγίζοντας την σχέση $(\ref{eq:scheme_lyap})$ έχουμε:
\begin{equation}
\begin{split}
	\dot{V}(x,t) &= \xi^T(t) G^{-1}(x) \dot{\xi}(t)
		   + \sum_{i=1}^{m} \sum_{j=0}^{n_i - 1} 
		     \frac{\partial G^{-1}(x) }{\partial x_i^{(j)}} 
		     \frac{\partial }{\partial t} x_i^{(j)} \\
	% phi
	& - \sum_{i=1}^{m} \beta_{\varphi_i} 
	\tilde{w}_{\varphi_i}^{T} \dot{\hat{w}}_{\varphi_i} \\
	% gamma
	& - \sum_{i=1}^{m} \sum_{j=1}^{m} \beta_{\gamma_{ij}}
	\tilde{w}_{\varphi_{\gamma_{ij}}}^{T} \dot{\hat{w}}_{\varphi_{\gamma_{ij}}}
\end{split}
\label{eq:scheme_lyap}
\end{equation}

Καθώς υποθέτουμε συστήματα \emph{Euler-Lagrange}, επεκτείνοντας την υπόθεση 2 για τις μερικές παραγώγους της $G^{-1}(x)$ ( εξίσωση $(\ref{eq:assump_2})$ προκύπτει:
\begin{equation*}
	\sum_{i=1}^{m} \sum_{j=0}^{n_i - 1} 
	\frac{\partial G^{-1}(x) }{\partial x_i^{(j)}} 
	\frac{\partial }{\partial t} x_i^{(j)} = 
	%
	\sum_{i=1}^{m} \sum_{j=0}^{n_i - 2} 
	\frac{\partial G^{-1}(x) }{\partial x_i^{(j)}} 
	x_i^{(j +1)}
\end{equation*}
Ο λόγος που η υπόθεση 2 είναι τόσο σημαντική είναι ακριβώς επειδή μας επιτρέπει αυτή την απλοποίηση, χωρίς την οποία θα εμφανιζόταν στην ανάλυση μας οι είσοδοι $u_i(t)$ με αγνώστους συντελεστές, καθιστώντας την ανάλυση μη εφικτή.

Στην συνέχεια, αντικαθιστώντας την σχέση $(\ref{eq:xi_dot})$ έχουμε
\begin{equation}
	\begin{split}
	\dot{V}(x,t) &= 
	\frac{\xi^T(t)} {\rho(t)} G^{-1}(x) \left( F(x) + G(x)u(t) + d(t) - \xi(t)\dot{\rho}(t) \right)  \\
	&+ \sum_{i=1}^{m} \sum_{j=0}^{n_i - 2} 
	\frac{\partial G^{-1}(x) }{\partial x_i^{(j)}} x_i^{(j +1)}\\
	% phi
	& - \sum_{i=1}^{m} \beta_{\varphi_i} 
	\tilde{w}_{\varphi_i}^{T} \dot{\hat{w}}_{\varphi_i} 
	% gamma
	- \sum_{i=1}^{m} \sum_{j=1}^{m} \beta_{\gamma_{ij}}
	\tilde{w}_{\varphi_{\gamma_{ij}}}^{T} \dot{\hat{w}}_{\varphi_{\gamma_{ij}}}
	\end{split}
	%\label{eq:scheme_lyap}
\end{equation}

Συνεχίζοντας με την ανάλυση του πρώτου όρου, αντικαθιστούμε την είσοδο ελέγχου $u(t)$ από την εξίσωση $(\ref{eq:schema_control_input})$:
\begin{equation*}
\begin{split}
	\dot{V}_1(x) & := \frac{\xi^T(t)} {\rho(t)} G^{-1}(x) \Big( F(x) + G(x)u(t) + d(t) - \xi(t)\dot{\rho}(t) \Big)  \\
	 &=\frac{\xi^T(t)} {\rho(t)} \Big( \Phi(x) + u(t) 
	+  \Gamma(x) \big( d(t) - \xi(t)\dot{\rho}(t) \big)  \Big) \\
	 &=\frac{\xi^T(t)} {\rho(t)} \Big( T(\xi(t)) + \tilde{\Phi}(x)  
	 +  \tilde{\Gamma}(x) \big( d(t) - \xi(t)\dot{\rho}(t) \big)  \Big)
\end{split}
\end{equation*}

\end{proof}